make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Sat Dec 20 07:14:24 PM KST 2025
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/weights.bin
[CUDA][INFO] Starting inference loop [0, 15)
[CUDA][INFO] Loading data from data/0/input_ids.bin
Text 0 | Seq Len: 13
   Median: 10847.5 μs
   IQR:    309.5 μs (10649 to 10958.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/1/input_ids.bin
Text 1 | Seq Len: 17
   Median: 10890 μs
   IQR:    127.75 μs (10823.8 to 10951.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/2/input_ids.bin
Text 2 | Seq Len: 64
   Median: 15398.5 μs
   IQR:    24 μs (15387 to 15411)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/3/input_ids.bin
Text 3 | Seq Len: 200
   Median: 33978.5 μs
   IQR:    345.5 μs (33812.8 to 34158.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/4/input_ids.bin
Text 4 | Seq Len: 301
   Median: 51021 μs
   IQR:    332.5 μs (50820.2 to 51152.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/5/input_ids.bin
Text 5 | Seq Len: 305
   Median: 51012.5 μs
   IQR:    431 μs (50913 to 51344)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/6/input_ids.bin
Text 6 | Seq Len: 320
   Median: 52274 μs
   IQR:    281.5 μs (52156.2 to 52437.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/7/input_ids.bin
Text 7 | Seq Len: 332
   Median: 54838 μs
   IQR:    413.5 μs (54622.8 to 55036.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/8/input_ids.bin
Text 8 | Seq Len: 342
   Median: 59688.5 μs
   IQR:    318.25 μs (59534 to 59852.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/9/input_ids.bin
Text 9 | Seq Len: 344
   Median: 60220 μs
   IQR:    337 μs (60055 to 60392)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/10/input_ids.bin
Text 10 | Seq Len: 363
   Median: 64525.5 μs
   IQR:    413.75 μs (64316.5 to 64730.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/11/input_ids.bin
Text 11 | Seq Len: 364
   Median: 63552.5 μs
   IQR:    761.75 μs (63175 to 63936.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/12/input_ids.bin
Text 12 | Seq Len: 367
   Median: 64986.5 μs
   IQR:    460.75 μs (64716.8 to 65177.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/13/input_ids.bin
Text 13 | Seq Len: 371
   Median: 64971 μs
   IQR:    457.25 μs (64819.5 to 65276.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/14/input_ids.bin
Text 14 | Seq Len: 732
   Median: 117632 μs
   IQR:    554.5 μs (117429 to 117984)
   5 warmups, 20 iterations
Generating '/tmp/nsys-report-78ed.qdstrm'

[1/8] [0%                          ] report.nsys-rep
[1/8] [0%                          ] report.nsys-rep
[1/8] [5%                          ] report.nsys-rep
[1/8] [12%                         ] report.nsys-rep
[1/8] [10%                         ] report.nsys-rep
[1/8] [9%                          ] report.nsys-rep
[1/8] [=16%                        ] report.nsys-rep
[1/8] [=15%                        ] report.nsys-rep
[1/8] [14%                         ] report.nsys-rep
[1/8] [13%                         ] report.nsys-rep
[1/8] [12%                         ] report.nsys-rep
[1/8] [11%                         ] report.nsys-rep
[1/8] [10%                         ] report.nsys-rep
[1/8] [9%                          ] report.nsys-rep
[1/8] [8%                          ] report.nsys-rep
[1/8] [7%                          ] report.nsys-rep
[1/8] [6%                          ] report.nsys-rep
[1/8] [5%                          ] report.nsys-rep
[1/8] [5%                          ] report.nsys-rep
[1/8] [6%                          ] report.nsys-rep
[1/8] [7%                          ] report.nsys-rep
[1/8] [8%                          ] report.nsys-rep
[1/8] [10%                         ] report.nsys-rep
[1/8] [11%                         ] report.nsys-rep
[1/8] [12%                         ] report.nsys-rep
[1/8] [13%                         ] report.nsys-rep
[1/8] [14%                         ] report.nsys-rep
[1/8] [=15%                        ] report.nsys-rep
[1/8] [=16%                        ] report.nsys-rep
[1/8] [=17%                        ] report.nsys-rep
[1/8] [==18%                       ] report.nsys-rep
[1/8] [==19%                       ] report.nsys-rep
[1/8] [==20%                       ] report.nsys-rep
[1/8] [==21%                       ] report.nsys-rep
[1/8] [===22%                      ] report.nsys-rep
[1/8] [===24%                      ] report.nsys-rep
[1/8] [====25%                     ] report.nsys-rep
[1/8] [====26%                     ] report.nsys-rep
[1/8] [====27%                     ] report.nsys-rep
[1/8] [====28%                     ] report.nsys-rep
[1/8] [=====29%                    ] report.nsys-rep
[1/8] [=====30%                    ] report.nsys-rep
[1/8] [=====31%                    ] report.nsys-rep
[1/8] [=====32%                    ] report.nsys-rep
[1/8] [======33%                   ] report.nsys-rep
[1/8] [======34%                   ] report.nsys-rep
[1/8] [======35%                   ] report.nsys-rep
[1/8] [=======36%                  ] report.nsys-rep
[1/8] [=======37%                  ] report.nsys-rep
[1/8] [=======39%                  ] report.nsys-rep
[1/8] [========40%                 ] report.nsys-rep
[1/8] [========41%                 ] report.nsys-rep
[1/8] [========42%                 ] report.nsys-rep
[1/8] [=========43%                ] report.nsys-rep
[1/8] [=========44%                ] report.nsys-rep
[1/8] [=========45%                ] report.nsys-rep
[1/8] [=========46%                ] report.nsys-rep
[1/8] [==========47%               ] report.nsys-rep
[1/8] [==========48%               ] report.nsys-rep
[1/8] [===========50%              ] report.nsys-rep
[1/8] [===========51%              ] report.nsys-rep
[1/8] [===========52%              ] report.nsys-rep
[1/8] [===========53%              ] report.nsys-rep
[1/8] [============54%             ] report.nsys-rep
[1/8] [============55%             ] report.nsys-rep
[1/8] [============56%             ] report.nsys-rep
[1/8] [============57%             ] report.nsys-rep
[1/8] [=============58%            ] report.nsys-rep
[1/8] [=============59%            ] report.nsys-rep
[1/8] [=============60%            ] report.nsys-rep
[1/8] [==============62%           ] report.nsys-rep
[1/8] [==============63%           ] report.nsys-rep
[1/8] [==============64%           ] report.nsys-rep
[1/8] [===============65%          ] report.nsys-rep
[1/8] [===============66%          ] report.nsys-rep
[1/8] [===============67%          ] report.nsys-rep
[1/8] [================68%         ] report.nsys-rep
[1/8] [================69%         ] report.nsys-rep
[1/8] [================70%         ] report.nsys-rep
[1/8] [================71%         ] report.nsys-rep
[1/8] [=================72%        ] report.nsys-rep
[1/8] [=================73%        ] report.nsys-rep
[1/8] [=================74%        ] report.nsys-rep
[1/8] [==================76%       ] report.nsys-rep
[1/8] [==================77%       ] report.nsys-rep
[1/8] [==================78%       ] report.nsys-rep
[1/8] [===================79%      ] report.nsys-rep
[1/8] [===================80%      ] report.nsys-rep
[1/8] [===================81%      ] report.nsys-rep
[1/8] [========================100%] report.nsys-rep
[1/8] [========================100%] report.nsys-rep

[2/8] [0%                          ] report.sqlite
[2/8] [1%                          ] report.sqlite
[2/8] [2%                          ] report.sqlite
[2/8] [3%                          ] report.sqlite
[2/8] [4%                          ] report.sqlite
[2/8] [5%                          ] report.sqlite
[2/8] [6%                          ] report.sqlite
[2/8] [7%                          ] report.sqlite
[2/8] [8%                          ] report.sqlite
[2/8] [9%                          ] report.sqlite
[2/8] [10%                         ] report.sqlite
[2/8] [11%                         ] report.sqlite
[2/8] [12%                         ] report.sqlite
[2/8] [13%                         ] report.sqlite
[2/8] [14%                         ] report.sqlite
[2/8] [=15%                        ] report.sqlite
[2/8] [=16%                        ] report.sqlite
[2/8] [=17%                        ] report.sqlite
[2/8] [==18%                       ] report.sqlite
[2/8] [==19%                       ] report.sqlite
[2/8] [==20%                       ] report.sqlite
[2/8] [==21%                       ] report.sqlite
[2/8] [===22%                      ] report.sqlite
[2/8] [===23%                      ] report.sqlite
[2/8] [===24%                      ] report.sqlite
[2/8] [====25%                     ] report.sqlite
[2/8] [====26%                     ] report.sqlite
[2/8] [====27%                     ] report.sqlite
[2/8] [====28%                     ] report.sqlite
[2/8] [=====29%                    ] report.sqlite
[2/8] [=====30%                    ] report.sqlite
[2/8] [=====31%                    ] report.sqlite
[2/8] [=====32%                    ] report.sqlite
[2/8] [======33%                   ] report.sqlite
[2/8] [======34%                   ] report.sqlite
[2/8] [======35%                   ] report.sqlite
[2/8] [=======36%                  ] report.sqlite
[2/8] [=======37%                  ] report.sqlite
[2/8] [=======38%                  ] report.sqlite
[2/8] [=======39%                  ] report.sqlite
[2/8] [========40%                 ] report.sqlite
[2/8] [========41%                 ] report.sqlite
[2/8] [========42%                 ] report.sqlite
[2/8] [=========43%                ] report.sqlite
[2/8] [=========44%                ] report.sqlite
[2/8] [=========45%                ] report.sqlite
[2/8] [=========46%                ] report.sqlite
[2/8] [==========47%               ] report.sqlite
[2/8] [==========48%               ] report.sqlite
[2/8] [==========49%               ] report.sqlite
[2/8] [===========50%              ] report.sqlite
[2/8] [===========51%              ] report.sqlite
[2/8] [===========52%              ] report.sqlite
[2/8] [===========53%              ] report.sqlite
[2/8] [============54%             ] report.sqlite
[2/8] [============55%             ] report.sqlite
[2/8] [============56%             ] report.sqlite
[2/8] [============57%             ] report.sqlite
[2/8] [=============58%            ] report.sqlite
[2/8] [=============59%            ] report.sqlite
[2/8] [=============60%            ] report.sqlite
[2/8] [==============61%           ] report.sqlite
[2/8] [==============62%           ] report.sqlite
[2/8] [==============63%           ] report.sqlite
[2/8] [==============64%           ] report.sqlite
[2/8] [===============65%          ] report.sqlite
[2/8] [===============66%          ] report.sqlite
[2/8] [===============67%          ] report.sqlite
[2/8] [================68%         ] report.sqlite
[2/8] [================69%         ] report.sqlite
[2/8] [================70%         ] report.sqlite
[2/8] [================71%         ] report.sqlite
[2/8] [=================72%        ] report.sqlite
[2/8] [=================73%        ] report.sqlite
[2/8] [=================74%        ] report.sqlite
[2/8] [==================75%       ] report.sqlite
[2/8] [==================76%       ] report.sqlite
[2/8] [==================77%       ] report.sqlite
[2/8] [==================78%       ] report.sqlite
[2/8] [===================79%      ] report.sqlite
[2/8] [===================80%      ] report.sqlite
[2/8] [===================81%      ] report.sqlite
[2/8] [===================82%      ] report.sqlite
[2/8] [====================83%     ] report.sqlite
[2/8] [====================84%     ] report.sqlite
[2/8] [====================85%     ] report.sqlite
[2/8] [=====================86%    ] report.sqlite
[2/8] [=====================87%    ] report.sqlite
[2/8] [=====================88%    ] report.sqlite
[2/8] [=====================89%    ] report.sqlite
[2/8] [======================90%   ] report.sqlite
[2/8] [======================91%   ] report.sqlite
[2/8] [======================92%   ] report.sqlite
[2/8] [=======================93%  ] report.sqlite
[2/8] [=======================94%  ] report.sqlite
[2/8] [=======================95%  ] report.sqlite
[2/8] [=======================96%  ] report.sqlite
[2/8] [========================97% ] report.sqlite
[2/8] [========================98% ] report.sqlite
[2/8] [========================99% ] report.sqlite
[2/8] [========================100%] report.sqlite
[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     46.3   21,731,721,225        227   95,734,454.7  100,146,000.0        8,480  100,198,238  19,813,434.5  poll                  
     45.8   21,503,477,714         43  500,080,877.1  500,079,629.0  500,046,976  500,103,173      12,721.8  pthread_cond_timedwait
      7.5    3,525,333,359    157,012       22,452.6       13,680.0          470   20,574,124      60,616.6  ioctl                 
      0.4      180,236,876     79,647        2,262.9        2,241.0          481       78,356         450.1  read                  
      0.0       15,202,060         27      563,039.3      364,237.0          430    4,262,678     861,984.8  pthread_rwlock_wrlock 
      0.0        1,999,654         33       60,595.6       11,415.0        4,944    1,214,398     208,452.8  mmap64                
      0.0          656,315         56       11,719.9       12,001.0        4,101       16,889       3,077.0  open64                
      0.0          631,532          9       70,170.2       21,087.0       10,209      420,600     133,577.7  sem_timedwait         
      0.0          288,440         44        6,555.5        6,336.5        1,639       15,408       3,125.7  munmap                
      0.0          278,305         33        8,433.5        6,040.0        1,730       60,567      10,168.3  mmap                  
      0.0          181,378         16       11,336.1       10,741.0        6,041       16,325       2,601.0  fopen64               
      0.0          162,379         37        4,388.6        2,442.0          914       16,155       3,941.3  fopen                 
      0.0          159,868          3       53,289.3       56,546.0       33,641       69,681      18,239.4  pthread_create        
      0.0          144,054          4       36,013.5       39,582.5        9,578       55,311      19,296.9  pthread_mutex_lock    
      0.0          110,297         43        2,565.0        1,068.0           31        6,928       2,507.1  fflush                
      0.0           84,474         46        1,836.4        1,460.5          567        6,874       1,113.8  fclose                
      0.0           38,989        321          121.5           43.0           34        3,170         338.6  fwrite                
      0.0           34,131         25        1,365.2           41.0           37       33,081       6,607.5  fgets                 
      0.0           25,883          6        4,313.8        4,316.0        1,224        7,742       2,435.3  open                  
      0.0           25,109         63          398.6          345.0          201        1,140         200.2  fcntl                 
      0.0           16,686          2        8,343.0        8,343.0        4,620       12,066       5,265.1  socket                
      0.0           15,239         10        1,523.9        1,528.0          654        2,379         635.5  write                 
      0.0           12,837          1       12,837.0       12,837.0       12,837       12,837           0.0  connect               
      0.0           10,527          1       10,527.0       10,527.0       10,527       10,527           0.0  pipe2                 
      0.0            3,895         33          118.0           63.0           32          272          85.7  putc                  
      0.0            2,703         64           42.2           24.0           23          886         110.4  pthread_mutex_trylock 
      0.0            2,246          1        2,246.0        2,246.0        2,246        2,246           0.0  bind                  
      0.0            2,004          7          286.3          286.0          218          378          60.0  dup                   
      0.0              944          1          944.0          944.0          944          944           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)  Min (ns)   Max (ns)   StdDev (ns)           Name         
 --------  ---------------  ---------  ---------  --------  --------  ----------  -----------  ----------------------
     81.0   15,759,913,687     59,939  262,932.5   2,342.0     1,017   4,897,997    627,347.8  cudaFree              
      9.5    1,848,368,190    546,001    3,385.3   3,232.0     2,620   1,538,803      5,300.1  cudaLaunchKernel      
      8.5    1,652,200,004     59,939   27,564.7   2,216.0     1,151  71,012,005    291,839.0  cudaMalloc            
      1.0      189,664,440      9,313   20,365.6   9,268.0     3,369  30,279,674    436,831.8  cudaMemcpy            
      0.0            2,634          1    2,634.0   2,634.0     2,634       2,634          0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  ---------  -----------  ----------------------------------------------------------------------------------------------------
     71.1   11,320,945,018    126,375  89,582.2  14,912.0     1,823  1,656,716    226,602.3  operations::naive_matrix_multiplication_kernel(float *, const float *, const float *, int, int, int)
     20.9    3,333,838,077     54,000  61,737.7  60,960.0     3,231    173,761     37,833.3  operations::naive_softmax_kernel(float *, int, int)                                                 
      3.6      572,206,787      9,375  61,035.4  60,576.0    54,881     77,313      3,499.7  operations::naive_layer_norm_kernel(float *, const float *, const float *, int, float)              
      1.3      209,779,672    162,000   1,294.9   1,248.0     1,120      2,784        158.1  extract_head_kernel(float *, const float *, int, int, int, int, int)                                
      0.8      134,527,536     18,000   7,473.8   5,120.0     1,504     30,817      5,546.2  operations::add_bias_kernel(float *, const float *, int, long)                                      
      0.8      119,601,412     54,001   2,214.8   2,240.0     1,183  1,295,337      5,583.3  operations::naive_transpose_kernel(float *, const float *, int, int)                                
      0.5       84,228,513     54,000   1,559.8   1,504.0     1,120      3,168        441.0  causal_mask_and_scale_kernel(float *, int, float)                                                   
      0.4       65,758,716     54,000   1,217.8   1,216.0     1,120      1,888         98.1  insert_head_kernel(float *, const float *, int, int, int, int)                                      
      0.3       40,663,891      4,500   9,036.4   8,865.0     1,663     32,544      6,752.4  operations::gelu_kernel(float *, long)                                                              
      0.2       35,854,045      9,000   3,983.8   4,160.0     1,407      8,768      1,600.3  operations::add_kernel(float *, const float *, long)                                                
      0.0        1,950,707        375   5,201.9   5,600.0     2,048      9,983      1,842.9  operations::embed_kernel(float *, const float *, const float *, const int *, int)                   
      0.0          427,520        375   1,140.1   1,152.0     1,120      1,216         19.8  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)   Max (ns)   StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  ----------  -----------  ------------------------------
     79.7      101,991,941    164  621,902.1     673.0       416  29,964,888  3,215,695.3  [CUDA memcpy Host-to-Device]  
     20.3       26,053,697  9,149    2,847.7   2,272.0     1,120     521,795      7,943.4  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  8,826.741  9,149     0.965     1.020     0.003   154.390        2.381  [CUDA memcpy Device-to-Device]
    652.166    164     3.977     0.003     0.000   154.390       17.141  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Sat Dec 20 07:15:08 PM KST 2025
