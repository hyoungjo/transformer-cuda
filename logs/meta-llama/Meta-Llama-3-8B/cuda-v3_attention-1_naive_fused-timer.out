make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude -c source/llama3_8b.cu -o source/llama3_8b.o
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/main.o -o main
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/timer.o -o timer
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Thu Jan  1 04:53:24 PM KST 2026
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/weights.bin
[CUDA][INFO] Starting inference loop
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/0/input_ids.bin
Text 0 | Seq Len: 14
   Median: 151 ms
   IQR:    1 ms (150 to 151)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/2/input_ids.bin
Text 2 | Seq Len: 63
   Median: 210 ms
   IQR:    0.75 ms (210 to 210.75)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/3/input_ids.bin
Text 3 | Seq Len: 192
   Median: 550 ms
   IQR:    273.75 ms (550 to 823.75)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/13/input_ids.bin
Text 13 | Seq Len: 352
   Median: 1228.5 ms
   IQR:    368.25 ms (1053 to 1421.25)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/14/input_ids.bin
Text 14 | Seq Len: 713
   Median: 3527.5 ms
   IQR:    347.5 ms (3348.25 to 3695.75)
   3 warmups, 10 iterations
Generating '/tmp/nsys-report-cff6.qdstrm'
[1/8] [0%                          ] report.nsys-rep[1/8] [0%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [=16%                        ] report.nsys-rep[1/8] [=17%                        ] report.nsys-rep[1/8] [==18%                       ] report.nsys-rep[1/8] [==19%                       ] report.nsys-rep[1/8] [==20%                       ] report.nsys-rep[1/8] [==21%                       ] report.nsys-rep[1/8] [===22%                      ] report.nsys-rep[1/8] [===23%                      ] report.nsys-rep[1/8] [===24%                      ] report.nsys-rep[1/8] [====25%                     ] report.nsys-rep[1/8] [====26%                     ] report.nsys-rep[1/8] [====27%                     ] report.nsys-rep[1/8] [====28%                     ] report.nsys-rep[1/8] [=====29%                    ] report.nsys-rep[1/8] [=====30%                    ] report.nsys-rep[1/8] [=====31%                    ] report.nsys-rep[1/8] [=====32%                    ] report.nsys-rep[1/8] [======33%                   ] report.nsys-rep[1/8] [======34%                   ] report.nsys-rep[1/8] [======35%                   ] report.nsys-rep[1/8] [=======36%                  ] report.nsys-rep[1/8] [=======37%                  ] report.nsys-rep[1/8] [=======38%                  ] report.nsys-rep[1/8] [=======39%                  ] report.nsys-rep[1/8] [========40%                 ] report.nsys-rep[1/8] [========41%                 ] report.nsys-rep[1/8] [========42%                 ] report.nsys-rep[1/8] [=========43%                ] report.nsys-rep[1/8] [=========44%                ] report.nsys-rep[1/8] [=========45%                ] report.nsys-rep[1/8] [=========46%                ] report.nsys-rep[1/8] [==========47%               ] report.nsys-rep[1/8] [==========48%               ] report.nsys-rep[1/8] [==========49%               ] report.nsys-rep[1/8] [===========50%              ] report.nsys-rep[1/8] [===========51%              ] report.nsys-rep[1/8] [===========52%              ] report.nsys-rep[1/8] [===========53%              ] report.nsys-rep[1/8] [============54%             ] report.nsys-rep[1/8] [============55%             ] report.nsys-rep[1/8] [============56%             ] report.nsys-rep[1/8] [============57%             ] report.nsys-rep[1/8] [=============58%            ] report.nsys-rep[1/8] [=============59%            ] report.nsys-rep[1/8] [=============60%            ] report.nsys-rep[1/8] [==============61%           ] report.nsys-rep[1/8] [==============62%           ] report.nsys-rep[1/8] [==============63%           ] report.nsys-rep[1/8] [==============64%           ] report.nsys-rep[1/8] [===============65%          ] report.nsys-rep[1/8] [===============66%          ] report.nsys-rep[1/8] [===============67%          ] report.nsys-rep[1/8] [================68%         ] report.nsys-rep[1/8] [================69%         ] report.nsys-rep[1/8] [================70%         ] report.nsys-rep[1/8] [================71%         ] report.nsys-rep[1/8] [=================72%        ] report.nsys-rep[1/8] [=================73%        ] report.nsys-rep[1/8] [=================74%        ] report.nsys-rep[1/8] [==================75%       ] report.nsys-rep[1/8] [==================76%       ] report.nsys-rep[1/8] [==================77%       ] report.nsys-rep[1/8] [==================78%       ] report.nsys-rep[1/8] [===================79%      ] report.nsys-rep[1/8] [===================80%      ] report.nsys-rep[1/8] [===================81%      ] report.nsys-rep[1/8] [===================82%      ] report.nsys-rep[1/8] [====================83%     ] report.nsys-rep[1/8] [====================84%     ] report.nsys-rep[1/8] [====================85%     ] report.nsys-rep[1/8] [=====================86%    ] report.nsys-rep[1/8] [=====================87%    ] report.nsys-rep[1/8] [=====================88%    ] report.nsys-rep[1/8] [=====================89%    ] report.nsys-rep[1/8] [======================90%   ] report.nsys-rep[1/8] [======================91%   ] report.nsys-rep[1/8] [======================92%   ] report.nsys-rep[1/8] [=======================93%  ] report.nsys-rep[1/8] [=======================94%  ] report.nsys-rep[1/8] [=======================95%  ] report.nsys-rep[1/8] [=======================96%  ] report.nsys-rep[1/8] [========================97% ] report.nsys-rep[1/8] [========================98% ] report.nsys-rep[1/8] [========================99% ] report.nsys-rep[1/8] [========================100%] report.nsys-rep[1/8] [========================100%] report.nsys-rep
[2/8] [0%                          ] report.sqlite[2/8] [1%                          ] report.sqlite[2/8] [2%                          ] report.sqlite[2/8] [3%                          ] report.sqlite[2/8] [4%                          ] report.sqlite[2/8] [5%                          ] report.sqlite[2/8] [6%                          ] report.sqlite[2/8] [7%                          ] report.sqlite[2/8] [8%                          ] report.sqlite[2/8] [9%                          ] report.sqlite[2/8] [10%                         ] report.sqlite[2/8] [11%                         ] report.sqlite[2/8] [12%                         ] report.sqlite[2/8] [13%                         ] report.sqlite[2/8] [14%                         ] report.sqlite[2/8] [=15%                        ] report.sqlite[2/8] [=16%                        ] report.sqlite[2/8] [=17%                        ] report.sqlite[2/8] [==18%                       ] report.sqlite[2/8] [==19%                       ] report.sqlite[2/8] [==20%                       ] report.sqlite[2/8] [==21%                       ] report.sqlite[2/8] [===22%                      ] report.sqlite[2/8] [===23%                      ] report.sqlite[2/8] [===24%                      ] report.sqlite[2/8] [====25%                     ] report.sqlite[2/8] [====26%                     ] report.sqlite[2/8] [====27%                     ] report.sqlite[2/8] [====28%                     ] report.sqlite[2/8] [=====29%                    ] report.sqlite[2/8] [=====30%                    ] report.sqlite[2/8] [=====31%                    ] report.sqlite[2/8] [=====32%                    ] report.sqlite[2/8] [======33%                   ] report.sqlite[2/8] [======34%                   ] report.sqlite[2/8] [======35%                   ] report.sqlite[2/8] [=======36%                  ] report.sqlite[2/8] [=======37%                  ] report.sqlite[2/8] [=======38%                  ] report.sqlite[2/8] [=======39%                  ] report.sqlite[2/8] [========40%                 ] report.sqlite[2/8] [========41%                 ] report.sqlite[2/8] [========42%                 ] report.sqlite[2/8] [=========43%                ] report.sqlite[2/8] [=========44%                ] report.sqlite[2/8] [=========45%                ] report.sqlite[2/8] [=========46%                ] report.sqlite[2/8] [==========47%               ] report.sqlite[2/8] [==========48%               ] report.sqlite[2/8] [==========49%               ] report.sqlite[2/8] [===========50%              ] report.sqlite[2/8] [===========51%              ] report.sqlite[2/8] [===========52%              ] report.sqlite[2/8] [===========53%              ] report.sqlite[2/8] [============54%             ] report.sqlite[2/8] [============55%             ] report.sqlite[2/8] [============56%             ] report.sqlite[2/8] [============57%             ] report.sqlite[2/8] [=============58%            ] report.sqlite[2/8] [=============59%            ] report.sqlite[2/8] [=============60%            ] report.sqlite[2/8] [==============61%           ] report.sqlite[2/8] [==============62%           ] report.sqlite[2/8] [==============63%           ] report.sqlite[2/8] [==============64%           ] report.sqlite[2/8] [===============65%          ] report.sqlite[2/8] [===============66%          ] report.sqlite[2/8] [===============67%          ] report.sqlite[2/8] [================68%         ] report.sqlite[2/8] [================69%         ] report.sqlite[2/8] [================70%         ] report.sqlite[2/8] [================71%         ] report.sqlite[2/8] [=================72%        ] report.sqlite[2/8] [=================73%        ] report.sqlite[2/8] [=================74%        ] report.sqlite[2/8] [==================75%       ] report.sqlite[2/8] [==================76%       ] report.sqlite[2/8] [==================77%       ] report.sqlite[2/8] [==================78%       ] report.sqlite[2/8] [===================79%      ] report.sqlite[2/8] [===================80%      ] report.sqlite[2/8] [===================81%      ] report.sqlite[2/8] [===================82%      ] report.sqlite[2/8] [====================83%     ] report.sqlite[2/8] [====================84%     ] report.sqlite[2/8] [====================85%     ] report.sqlite[2/8] [=====================86%    ] report.sqlite[2/8] [=====================87%    ] report.sqlite[2/8] [=====================88%    ] report.sqlite[2/8] [=====================89%    ] report.sqlite[2/8] [======================90%   ] report.sqlite[2/8] [======================91%   ] report.sqlite[2/8] [======================92%   ] report.sqlite[2/8] [=======================93%  ] report.sqlite[2/8] [=======================94%  ] report.sqlite[2/8] [=======================95%  ] report.sqlite[2/8] [=======================96%  ] report.sqlite[2/8] [========================97% ] report.sqlite[2/8] [========================98% ] report.sqlite[2/8] [========================99% ] report.sqlite[2/8] [========================100%] report.sqlite[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     47.2  204,303,352,805      2,050   99,660,172.1  100,155,476.5        8,127  100,225,614   6,722,563.4  poll                  
     47.1  204,032,104,038        408  500,078,686.4  500,071,294.5  500,058,663  500,214,732      16,065.4  pthread_cond_timedwait
      4.2   17,995,959,325    110,646      162,644.5       14,853.0          371  258,422,004   3,468,683.4  ioctl                 
      1.5    6,469,259,357  3,921,525        1,649.7        1,559.0          467      361,392         430.1  read                  
      0.0       31,730,617          2   15,865,308.5   15,865,308.5    1,266,541   30,464,076  20,645,775.0  pthread_rwlock_wrlock 
      0.0        6,665,575      1,039        6,415.4        4,653.0        1,233       36,822       4,434.9  munmap                
      0.0        5,416,933        531       10,201.4        9,644.0        1,697       69,046       7,366.8  mmap                  
      0.0        1,996,275         33       60,493.2       10,723.0        5,486    1,283,695     220,716.5  mmap64                
      0.0          954,644         56       17,047.2       11,733.5        3,824      292,531      37,669.1  open64                
      0.0          584,337          9       64,926.3       20,853.0       12,517      351,096     109,653.0  sem_timedwait         
      0.0          313,990          3      104,663.3       54,127.0       20,609      239,254     117,757.6  pthread_mutex_lock    
      0.0          177,733          3       59,244.3       68,192.0       38,565       70,976      17,962.8  pthread_create        
      0.0          141,645         37        3,828.2        2,319.0          786       14,254       3,360.1  fopen                 
      0.0           72,728          6       12,121.3       12,825.0        7,320       15,833       2,865.9  fopen64               
      0.0           57,798         36        1,605.5        1,215.0          728        8,754       1,347.5  fclose                
      0.0           48,698         23        2,117.3          793.0           37        7,699       2,758.4  fflush                
      0.0           32,273         25        1,290.9           43.0           34       31,251       6,241.7  fgets                 
      0.0           25,027         63          397.3          381.0          184        1,031         170.8  fcntl                 
      0.0           23,247          6        3,874.5        4,416.0        1,182        6,057       1,981.1  open                  
      0.0           18,538         10        1,853.8        1,902.5          625        3,349         873.1  write                 
      0.0           18,522        109          169.9           43.0           34        3,038         440.4  fwrite                
      0.0           17,413          2        8,706.5        8,706.5        4,449       12,964       6,021.0  socket                
      0.0           12,177          1       12,177.0       12,177.0       12,177       12,177           0.0  connect               
      0.0           10,984          1       10,984.0       10,984.0       10,984       10,984           0.0  pipe2                 
      0.0            3,328         64           52.0           29.0           27        1,089         135.4  pthread_mutex_trylock 
      0.0            2,268          7          324.0          326.0          242          412          60.6  dup                   
      0.0            2,232          1        2,232.0        2,232.0        2,232        2,232           0.0  bind                  
      0.0            1,993         13          153.3          224.0           31          301         108.9  putc                  
      0.0              981          1          981.0          981.0          981          981           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)   Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -----------  ---------  --------  -----------  ------------  ----------------------
     87.5   74,045,677,768     21,807  3,395,500.4  140,987.0     1,104  376,014,276  13,718,999.8  cudaFree              
      7.5    6,305,795,147      4,843  1,302,043.2    9,883.0     5,209  607,477,764  12,094,730.4  cudaMemcpy            
      4.8    4,089,100,342     21,807    187,513.2   64,478.0     1,211  459,211,196   4,787,553.2  cudaMalloc            
      0.2      145,315,367     33,765      4,303.7    3,752.0     2,783      503,082       3,333.7  cudaLaunchKernel      
      0.0            2,423          1      2,423.0    2,423.0     2,423        2,423           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                   Name                                                
 --------  ---------------  ---------  ------------  -----------  --------  ----------  ------------  ----------------------------------------------------------------------------------------------------
     51.8   31,146,689,913      2,080  14,974,370.2  4,391,023.0    80,959  57,425,684  21,041,495.7  naive_fused_attention_kernel(float *, const float *, const float *, const float *, int, int, int, i…
     47.2   28,375,685,755     14,625   1,940,217.8    904,057.0   412,157   9,588,851   2,440,865.2  operations::tensor_core_matrix_multiplication_kernel(float *, const float *, const float *, int, in…
      0.3      152,157,191      2,080      73,152.5     53,663.0     3,103     199,167      70,169.1  operations::multiply_kernel(float *, const float *, int)                                            
      0.2      122,617,509        225     544,966.7    275,422.0    65,087   8,568,991     668,319.6  operations::transpose_kernel(float *, const float *, int, int)                                      
      0.2      105,916,545      2,080      50,921.4     36,767.0     3,840     136,127      47,606.2  operations::silu_kernel(float *, long)                                                              
      0.1       84,728,785      4,160      20,367.5     12,704.5     2,048      57,983      19,334.2  operations::add_kernel(float *, const float *, long)                                                
      0.1       73,314,800      4,225      17,352.6     10,559.0     8,639      47,521      13,062.9  operations::rms_norm_kernel(float *, const float *, int, float)                                     
      0.1       51,003,276      4,160      12,260.4      7,744.0     2,367      43,104      11,581.8  operations::rope_kernel(float *, int, int)                                                          
      0.0          842,460         65      12,960.9      8,992.0     3,295      32,895      10,780.3  operations::embed_kernel(float *, const float *, const int *, int)                                  
      0.0           92,699         65       1,426.1      1,472.0     1,151       1,824         242.4  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count    Avg (ns)      Med (ns)    Min (ns)   Max (ns)    StdDev (ns)             Operation           
 --------  ---------------  -----  ------------  ------------  --------  -----------  ------------  ------------------------------
     96.8    6,224,685,696    296  21,029,343.6  12,463,586.0       448  607,157,485  44,486,180.0  [CUDA memcpy Host-to-Device]  
      3.2      206,526,454  4,547      45,420.4       6,912.0     1,184    7,049,163     198,641.2  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  ---------  -----------  ------------------------------
 60,505.997  4,547    13.307     3.146     0.016  2,101.346       58.763  [CUDA memcpy Device-to-Device]
 32,121.050    296   108.517    67.109     0.000  2,101.346      192.645  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Thu Jan  1 04:57:36 PM KST 2026
