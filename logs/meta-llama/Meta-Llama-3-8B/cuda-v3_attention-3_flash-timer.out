make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude -c source/llama3_8b.cu -o source/llama3_8b.o
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/main.o -o main
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/timer.o -o timer
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Thu Jan  1 05:16:25 PM KST 2026
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/weights.bin
[CUDA][INFO] Starting inference loop
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/0/input_ids.bin
Text 0 | Seq Len: 14
   Median: 147.5 ms
   IQR:    1 ms (147 to 148)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/2/input_ids.bin
Text 2 | Seq Len: 63
   Median: 192.5 ms
   IQR:    1 ms (192 to 193)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/3/input_ids.bin
Text 3 | Seq Len: 192
   Median: 419.5 ms
   IQR:    1.75 ms (418.25 to 420)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/13/input_ids.bin
Text 13 | Seq Len: 352
   Median: 634.5 ms
   IQR:    277.75 ms (633.25 to 911)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/14/input_ids.bin
Text 14 | Seq Len: 713
   Median: 1679.5 ms
   IQR:    360.5 ms (1324 to 1684.5)
   3 warmups, 10 iterations
Generating '/tmp/nsys-report-4818.qdstrm'
[1/8] [0%                          ] report.nsys-rep[1/8] [0%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [=16%                        ] report.nsys-rep[1/8] [=17%                        ] report.nsys-rep[1/8] [==18%                       ] report.nsys-rep[1/8] [==19%                       ] report.nsys-rep[1/8] [==20%                       ] report.nsys-rep[1/8] [==21%                       ] report.nsys-rep[1/8] [===22%                      ] report.nsys-rep[1/8] [===23%                      ] report.nsys-rep[1/8] [===24%                      ] report.nsys-rep[1/8] [====25%                     ] report.nsys-rep[1/8] [====26%                     ] report.nsys-rep[1/8] [====27%                     ] report.nsys-rep[1/8] [====28%                     ] report.nsys-rep[1/8] [=====29%                    ] report.nsys-rep[1/8] [=====30%                    ] report.nsys-rep[1/8] [=====31%                    ] report.nsys-rep[1/8] [=====32%                    ] report.nsys-rep[1/8] [======33%                   ] report.nsys-rep[1/8] [======34%                   ] report.nsys-rep[1/8] [======35%                   ] report.nsys-rep[1/8] [=======36%                  ] report.nsys-rep[1/8] [=======37%                  ] report.nsys-rep[1/8] [=======38%                  ] report.nsys-rep[1/8] [=======39%                  ] report.nsys-rep[1/8] [========40%                 ] report.nsys-rep[1/8] [========41%                 ] report.nsys-rep[1/8] [========42%                 ] report.nsys-rep[1/8] [=========43%                ] report.nsys-rep[1/8] [=========44%                ] report.nsys-rep[1/8] [=========45%                ] report.nsys-rep[1/8] [=========46%                ] report.nsys-rep[1/8] [==========47%               ] report.nsys-rep[1/8] [==========48%               ] report.nsys-rep[1/8] [==========49%               ] report.nsys-rep[1/8] [===========50%              ] report.nsys-rep[1/8] [===========51%              ] report.nsys-rep[1/8] [===========52%              ] report.nsys-rep[1/8] [===========53%              ] report.nsys-rep[1/8] [============54%             ] report.nsys-rep[1/8] [============55%             ] report.nsys-rep[1/8] [============56%             ] report.nsys-rep[1/8] [============57%             ] report.nsys-rep[1/8] [=============58%            ] report.nsys-rep[1/8] [=============59%            ] report.nsys-rep[1/8] [=============60%            ] report.nsys-rep[1/8] [==============61%           ] report.nsys-rep[1/8] [==============62%           ] report.nsys-rep[1/8] [==============63%           ] report.nsys-rep[1/8] [==============64%           ] report.nsys-rep[1/8] [===============65%          ] report.nsys-rep[1/8] [===============66%          ] report.nsys-rep[1/8] [===============67%          ] report.nsys-rep[1/8] [================68%         ] report.nsys-rep[1/8] [================69%         ] report.nsys-rep[1/8] [================70%         ] report.nsys-rep[1/8] [================71%         ] report.nsys-rep[1/8] [=================72%        ] report.nsys-rep[1/8] [=================73%        ] report.nsys-rep[1/8] [=================74%        ] report.nsys-rep[1/8] [==================75%       ] report.nsys-rep[1/8] [==================76%       ] report.nsys-rep[1/8] [==================77%       ] report.nsys-rep[1/8] [==================78%       ] report.nsys-rep[1/8] [===================79%      ] report.nsys-rep[1/8] [===================80%      ] report.nsys-rep[1/8] [===================81%      ] report.nsys-rep[1/8] [===================82%      ] report.nsys-rep[1/8] [====================83%     ] report.nsys-rep[1/8] [====================84%     ] report.nsys-rep[1/8] [====================85%     ] report.nsys-rep[1/8] [=====================86%    ] report.nsys-rep[1/8] [=====================87%    ] report.nsys-rep[1/8] [=====================88%    ] report.nsys-rep[1/8] [=====================89%    ] report.nsys-rep[1/8] [======================90%   ] report.nsys-rep[1/8] [======================91%   ] report.nsys-rep[1/8] [======================92%   ] report.nsys-rep[1/8] [=======================93%  ] report.nsys-rep[1/8] [=======================94%  ] report.nsys-rep[1/8] [=======================95%  ] report.nsys-rep[1/8] [=======================96%  ] report.nsys-rep[1/8] [========================97% ] report.nsys-rep[1/8] [========================98% ] report.nsys-rep[1/8] [========================99% ] report.nsys-rep[1/8] [========================100%] report.nsys-rep[1/8] [========================100%] report.nsys-rep
[2/8] [0%                          ] report.sqlite[2/8] [1%                          ] report.sqlite[2/8] [2%                          ] report.sqlite[2/8] [3%                          ] report.sqlite[2/8] [4%                          ] report.sqlite[2/8] [5%                          ] report.sqlite[2/8] [6%                          ] report.sqlite[2/8] [7%                          ] report.sqlite[2/8] [8%                          ] report.sqlite[2/8] [9%                          ] report.sqlite[2/8] [10%                         ] report.sqlite[2/8] [11%                         ] report.sqlite[2/8] [12%                         ] report.sqlite[2/8] [13%                         ] report.sqlite[2/8] [14%                         ] report.sqlite[2/8] [=15%                        ] report.sqlite[2/8] [=16%                        ] report.sqlite[2/8] [=17%                        ] report.sqlite[2/8] [==18%                       ] report.sqlite[2/8] [==19%                       ] report.sqlite[2/8] [==20%                       ] report.sqlite[2/8] [==21%                       ] report.sqlite[2/8] [===22%                      ] report.sqlite[2/8] [===23%                      ] report.sqlite[2/8] [===24%                      ] report.sqlite[2/8] [====25%                     ] report.sqlite[2/8] [====26%                     ] report.sqlite[2/8] [====27%                     ] report.sqlite[2/8] [====28%                     ] report.sqlite[2/8] [=====29%                    ] report.sqlite[2/8] [=====30%                    ] report.sqlite[2/8] [=====31%                    ] report.sqlite[2/8] [=====32%                    ] report.sqlite[2/8] [======33%                   ] report.sqlite[2/8] [======34%                   ] report.sqlite[2/8] [======35%                   ] report.sqlite[2/8] [=======36%                  ] report.sqlite[2/8] [=======37%                  ] report.sqlite[2/8] [=======38%                  ] report.sqlite[2/8] [=======39%                  ] report.sqlite[2/8] [========40%                 ] report.sqlite[2/8] [========41%                 ] report.sqlite[2/8] [========42%                 ] report.sqlite[2/8] [=========43%                ] report.sqlite[2/8] [=========44%                ] report.sqlite[2/8] [=========45%                ] report.sqlite[2/8] [=========46%                ] report.sqlite[2/8] [==========47%               ] report.sqlite[2/8] [==========48%               ] report.sqlite[2/8] [==========49%               ] report.sqlite[2/8] [===========50%              ] report.sqlite[2/8] [===========51%              ] report.sqlite[2/8] [===========52%              ] report.sqlite[2/8] [===========53%              ] report.sqlite[2/8] [============54%             ] report.sqlite[2/8] [============55%             ] report.sqlite[2/8] [============56%             ] report.sqlite[2/8] [============57%             ] report.sqlite[2/8] [=============58%            ] report.sqlite[2/8] [=============59%            ] report.sqlite[2/8] [=============60%            ] report.sqlite[2/8] [==============61%           ] report.sqlite[2/8] [==============62%           ] report.sqlite[2/8] [==============63%           ] report.sqlite[2/8] [==============64%           ] report.sqlite[2/8] [===============65%          ] report.sqlite[2/8] [===============66%          ] report.sqlite[2/8] [===============67%          ] report.sqlite[2/8] [================68%         ] report.sqlite[2/8] [================69%         ] report.sqlite[2/8] [================70%         ] report.sqlite[2/8] [================71%         ] report.sqlite[2/8] [=================72%        ] report.sqlite[2/8] [=================73%        ] report.sqlite[2/8] [=================74%        ] report.sqlite[2/8] [==================75%       ] report.sqlite[2/8] [==================76%       ] report.sqlite[2/8] [==================77%       ] report.sqlite[2/8] [==================78%       ] report.sqlite[2/8] [===================79%      ] report.sqlite[2/8] [===================80%      ] report.sqlite[2/8] [===================81%      ] report.sqlite[2/8] [===================82%      ] report.sqlite[2/8] [====================83%     ] report.sqlite[2/8] [====================84%     ] report.sqlite[2/8] [====================85%     ] report.sqlite[2/8] [=====================86%    ] report.sqlite[2/8] [=====================87%    ] report.sqlite[2/8] [=====================88%    ] report.sqlite[2/8] [=====================89%    ] report.sqlite[2/8] [======================90%   ] report.sqlite[2/8] [======================91%   ] report.sqlite[2/8] [======================92%   ] report.sqlite[2/8] [=======================93%  ] report.sqlite[2/8] [=======================94%  ] report.sqlite[2/8] [=======================95%  ] report.sqlite[2/8] [=======================96%  ] report.sqlite[2/8] [========================97% ] report.sqlite[2/8] [========================98% ] report.sqlite[2/8] [========================99% ] report.sqlite[2/8] [========================100%] report.sqlite[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     47.1  174,030,414,536        348  500,087,398.1  500,092,514.5  500,060,719  500,159,478      14,881.1  pthread_cond_timedwait
     47.1  173,948,159,348      1,747   99,569,639.0  100,137,564.0        8,289  100,231,219   7,285,831.3  poll                  
      4.0   14,854,215,947    110,646      134,249.9       14,237.0          392  192,457,472   2,948,519.7  ioctl                 
      1.7    6,451,912,108  3,921,525        1,645.3        1,552.0          459    1,753,548         968.0  read                  
      0.0       32,390,465          2   16,195,232.5   16,195,232.5    1,335,100   31,055,365  21,015,400.9  pthread_rwlock_wrlock 
      0.0        6,154,609      1,039        5,923.6        4,590.0        1,275       48,190       4,155.2  munmap                
      0.0        5,111,693        531        9,626.5        8,154.0        1,581       70,659       6,949.1  mmap                  
      0.0        1,971,626         33       59,746.2        9,390.0        5,819    1,287,862     221,515.1  mmap64                
      0.0          761,931          6      126,988.5       39,391.0       14,965      589,139     227,192.9  pthread_mutex_lock    
      0.0          644,766         56       11,513.7       11,402.0        3,680       18,071       3,253.0  open64                
      0.0          621,100          9       69,011.1       18,369.0        9,564      435,219     138,942.5  sem_timedwait         
      0.0          164,008          3       54,669.3       61,914.0       35,313       66,781      16,938.8  pthread_create        
      0.0          143,863         37        3,888.2        2,157.0          800       14,146       3,296.7  fopen                 
      0.0           88,065          6       14,677.5       14,672.5        7,943       21,311       4,281.0  fopen64               
      0.0           59,788         36        1,660.8        1,154.5          725       10,602       1,668.2  fclose                
      0.0           53,089         23        2,308.2          817.0           33        7,441       3,040.3  fflush                
      0.0           37,762         25        1,510.5           38.0           34       36,786       7,349.1  fgets                 
      0.0           23,631         63          375.1          330.0          167          921         165.9  fcntl                 
      0.0           22,565          6        3,760.8        3,972.0        1,378        6,307       1,897.2  open                  
      0.0           19,393        109          177.9           42.0           32        3,263         449.7  fwrite                
      0.0           17,707          2        8,853.5        8,853.5        4,459       13,248       6,214.8  socket                
      0.0           17,366         10        1,736.6        1,600.0          629        3,403         990.3  write                 
      0.0           11,628          1       11,628.0       11,628.0       11,628       11,628           0.0  connect               
      0.0           10,310          1       10,310.0       10,310.0       10,310       10,310           0.0  pipe2                 
      0.0            2,995         64           46.8           26.0           24          968         120.5  pthread_mutex_trylock 
      0.0            2,174          1        2,174.0        2,174.0        2,174        2,174           0.0  bind                  
      0.0            1,909         13          146.8          216.0           31          280         108.3  putc                  
      0.0            1,817          7          259.6          293.0          201          314          54.7  dup                   
      0.0              919          1          919.0          919.0          919          919           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)   Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -----------  ---------  --------  -----------  ------------  ----------------------
     77.7   40,591,863,076     21,807  1,861,414.4  150,872.0     1,125  287,339,350   8,583,693.1  cudaFree              
     12.2    6,352,931,479      4,843  1,311,776.1    9,296.0     5,127  680,333,950  12,881,753.2  cudaMemcpy            
      9.8    5,126,830,021     21,807    235,100.2   63,638.0     1,242  260,333,449   5,036,024.5  cudaMalloc            
      0.3      139,708,166     33,765      4,137.7    3,536.0     2,660    1,366,019       8,067.9  cudaLaunchKernel      
      0.0            2,342          1      2,342.0    2,342.0     2,342        2,342           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  -----------  ---------  --------  ---------  -----------  ----------------------------------------------------------------------------------------------------
     93.7   28,912,580,107     14,625  1,976,928.6  913,922.0   411,810  9,992,634  2,498,923.3  operations::tensor_core_matrix_multiplication_kernel(float *, const float *, const float *, int, in…
      4.4    1,348,206,040      2,080    648,176.0  192,449.0     8,352  2,583,878    902,613.4  flash_attention_warp_kernel(float *, const float *, const float *, const float *, int, int, int, in…
      0.5      150,662,921      2,080     72,434.1   53,504.0     3,103    199,744     69,390.5  operations::multiply_kernel(float *, const float *, int)                                            
      0.4      122,523,988        225    544,551.1  275,137.0    64,736  8,562,615    667,851.1  operations::transpose_kernel(float *, const float *, int, int)                                      
      0.3      106,850,601      2,080     51,370.5   37,024.0     3,807    137,760     48,230.0  operations::silu_kernel(float *, long)                                                              
      0.3       84,449,312      4,160     20,300.3   12,736.0     2,048     56,448     19,164.6  operations::add_kernel(float *, const float *, long)                                                
      0.2       73,936,151      4,225     17,499.7   10,688.0     8,576     47,744     13,196.2  operations::rms_norm_kernel(float *, const float *, int, float)                                     
      0.2       51,877,686      4,160     12,470.6    7,887.5     2,367     44,000     11,733.4  operations::rope_kernel(float *, int, int)                                                          
      0.0          848,638         65     13,056.0    9,120.0     3,296     32,832     10,804.9  operations::embed_kernel(float *, const float *, const int *, int)                                  
      0.0           94,592         65      1,455.3    1,504.0     1,120      1,952        266.1  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count    Avg (ns)      Med (ns)    Min (ns)   Max (ns)    StdDev (ns)             Operation           
 --------  ---------------  -----  ------------  ------------  --------  -----------  ------------  ------------------------------
     96.8    6,277,578,545    296  21,208,035.6  12,451,442.5       448  680,014,204  47,899,135.2  [CUDA memcpy Host-to-Device]  
      3.2      206,431,153  4,547      45,399.4       6,848.0     1,184    7,031,059     198,560.9  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  ---------  -----------  ------------------------------
 60,505.997  4,547    13.307     3.146     0.016  2,101.346       58.763  [CUDA memcpy Device-to-Device]
 32,121.050    296   108.517    67.109     0.000  2,101.346      192.645  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Thu Jan  1 05:20:02 PM KST 2026
