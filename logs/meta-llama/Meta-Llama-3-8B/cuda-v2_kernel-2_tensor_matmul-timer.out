make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude -c source/llama3_8b.cu -o source/llama3_8b.o
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/main.o -o main
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/timer.o -o timer
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Thu Jan  1 04:09:31 PM KST 2026
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/weights.bin
[CUDA][INFO] Starting inference loop
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/0/input_ids.bin
Text 0 | Seq Len: 14
   Median: 193 ms
   IQR:    0.75 ms (193 to 193.75)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/2/input_ids.bin
Text 2 | Seq Len: 63
   Median: 245 ms
   IQR:    1 ms (244 to 245)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/3/input_ids.bin
Text 3 | Seq Len: 192
   Median: 493.5 ms
   IQR:    133 ms (493 to 626)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/13/input_ids.bin
Text 13 | Seq Len: 352
   Median: 844.5 ms
   IQR:    344.25 ms (746.25 to 1090.5)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/14/input_ids.bin
Text 14 | Seq Len: 713
   Median: 2000 ms
   IQR:    7.75 ms (1993.25 to 2001)
   3 warmups, 10 iterations
Generating '/tmp/nsys-report-efc5.qdstrm'
[1/8] [0%                          ] report.nsys-rep[1/8] [0%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [=16%                        ] report.nsys-rep[1/8] [=17%                        ] report.nsys-rep[1/8] [==18%                       ] report.nsys-rep[1/8] [==19%                       ] report.nsys-rep[1/8] [==20%                       ] report.nsys-rep[1/8] [==21%                       ] report.nsys-rep[1/8] [===22%                      ] report.nsys-rep[1/8] [===23%                      ] report.nsys-rep[1/8] [===24%                      ] report.nsys-rep[1/8] [====25%                     ] report.nsys-rep[1/8] [====26%                     ] report.nsys-rep[1/8] [====27%                     ] report.nsys-rep[1/8] [====28%                     ] report.nsys-rep[1/8] [=====29%                    ] report.nsys-rep[1/8] [=====30%                    ] report.nsys-rep[1/8] [=====31%                    ] report.nsys-rep[1/8] [=====32%                    ] report.nsys-rep[1/8] [======33%                   ] report.nsys-rep[1/8] [======34%                   ] report.nsys-rep[1/8] [======35%                   ] report.nsys-rep[1/8] [=======36%                  ] report.nsys-rep[1/8] [=======37%                  ] report.nsys-rep[1/8] [=======38%                  ] report.nsys-rep[1/8] [=======39%                  ] report.nsys-rep[1/8] [========40%                 ] report.nsys-rep[1/8] [========41%                 ] report.nsys-rep[1/8] [========42%                 ] report.nsys-rep[1/8] [=========43%                ] report.nsys-rep[1/8] [=========44%                ] report.nsys-rep[1/8] [=========45%                ] report.nsys-rep[1/8] [=========46%                ] report.nsys-rep[1/8] [==========47%               ] report.nsys-rep[1/8] [==========48%               ] report.nsys-rep[1/8] [==========49%               ] report.nsys-rep[1/8] [===========50%              ] report.nsys-rep[1/8] [===========51%              ] report.nsys-rep[1/8] [===========52%              ] report.nsys-rep[1/8] [===========53%              ] report.nsys-rep[1/8] [============54%             ] report.nsys-rep[1/8] [============55%             ] report.nsys-rep[1/8] [============56%             ] report.nsys-rep[1/8] [============57%             ] report.nsys-rep[1/8] [=============58%            ] report.nsys-rep[1/8] [=============59%            ] report.nsys-rep[1/8] [=============60%            ] report.nsys-rep[1/8] [==============61%           ] report.nsys-rep[1/8] [==============62%           ] report.nsys-rep[1/8] [==============63%           ] report.nsys-rep[1/8] [==============64%           ] report.nsys-rep[1/8] [===============65%          ] report.nsys-rep[1/8] [===============66%          ] report.nsys-rep[1/8] [===============67%          ] report.nsys-rep[1/8] [================68%         ] report.nsys-rep[1/8] [================69%         ] report.nsys-rep[1/8] [================70%         ] report.nsys-rep[1/8] [================71%         ] report.nsys-rep[1/8] [=================72%        ] report.nsys-rep[1/8] [=================73%        ] report.nsys-rep[1/8] [=================74%        ] report.nsys-rep[1/8] [==================75%       ] report.nsys-rep[1/8] [==================76%       ] report.nsys-rep[1/8] [==================77%       ] report.nsys-rep[1/8] [==================78%       ] report.nsys-rep[1/8] [===================79%      ] report.nsys-rep[1/8] [===================80%      ] report.nsys-rep[1/8] [===================81%      ] report.nsys-rep[1/8] [===================82%      ] report.nsys-rep[1/8] [====================83%     ] report.nsys-rep[1/8] [====================84%     ] report.nsys-rep[1/8] [====================85%     ] report.nsys-rep[1/8] [=====================86%    ] report.nsys-rep[1/8] [=====================87%    ] report.nsys-rep[1/8] [=====================88%    ] report.nsys-rep[1/8] [=====================89%    ] report.nsys-rep[1/8] [======================90%   ] report.nsys-rep[1/8] [======================91%   ] report.nsys-rep[1/8] [======================92%   ] report.nsys-rep[1/8] [=======================93%  ] report.nsys-rep[1/8] [=======================94%  ] report.nsys-rep[1/8] [========================100%] report.nsys-rep[1/8] [========================100%] report.nsys-rep
[2/8] [0%                          ] report.sqlite[2/8] [1%                          ] report.sqlite[2/8] [2%                          ] report.sqlite[2/8] [3%                          ] report.sqlite[2/8] [4%                          ] report.sqlite[2/8] [5%                          ] report.sqlite[2/8] [6%                          ] report.sqlite[2/8] [7%                          ] report.sqlite[2/8] [8%                          ] report.sqlite[2/8] [9%                          ] report.sqlite[2/8] [10%                         ] report.sqlite[2/8] [11%                         ] report.sqlite[2/8] [12%                         ] report.sqlite[2/8] [13%                         ] report.sqlite[2/8] [14%                         ] report.sqlite[2/8] [=15%                        ] report.sqlite[2/8] [=16%                        ] report.sqlite[2/8] [=17%                        ] report.sqlite[2/8] [==18%                       ] report.sqlite[2/8] [==19%                       ] report.sqlite[2/8] [==20%                       ] report.sqlite[2/8] [==21%                       ] report.sqlite[2/8] [===22%                      ] report.sqlite[2/8] [===23%                      ] report.sqlite[2/8] [===24%                      ] report.sqlite[2/8] [====25%                     ] report.sqlite[2/8] [====26%                     ] report.sqlite[2/8] [====27%                     ] report.sqlite[2/8] [====28%                     ] report.sqlite[2/8] [=====29%                    ] report.sqlite[2/8] [=====30%                    ] report.sqlite[2/8] [=====31%                    ] report.sqlite[2/8] [=====32%                    ] report.sqlite[2/8] [======33%                   ] report.sqlite[2/8] [======34%                   ] report.sqlite[2/8] [======35%                   ] report.sqlite[2/8] [=======36%                  ] report.sqlite[2/8] [=======37%                  ] report.sqlite[2/8] [=======38%                  ] report.sqlite[2/8] [=======39%                  ] report.sqlite[2/8] [========40%                 ] report.sqlite[2/8] [========41%                 ] report.sqlite[2/8] [========42%                 ] report.sqlite[2/8] [=========43%                ] report.sqlite[2/8] [=========44%                ] report.sqlite[2/8] [=========45%                ] report.sqlite[2/8] [=========46%                ] report.sqlite[2/8] [==========47%               ] report.sqlite[2/8] [==========48%               ] report.sqlite[2/8] [==========49%               ] report.sqlite[2/8] [===========50%              ] report.sqlite[2/8] [===========51%              ] report.sqlite[2/8] [===========52%              ] report.sqlite[2/8] [===========53%              ] report.sqlite[2/8] [============54%             ] report.sqlite[2/8] [============55%             ] report.sqlite[2/8] [============56%             ] report.sqlite[2/8] [============57%             ] report.sqlite[2/8] [=============58%            ] report.sqlite[2/8] [=============59%            ] report.sqlite[2/8] [=============60%            ] report.sqlite[2/8] [==============61%           ] report.sqlite[2/8] [==============62%           ] report.sqlite[2/8] [==============63%           ] report.sqlite[2/8] [==============64%           ] report.sqlite[2/8] [===============65%          ] report.sqlite[2/8] [===============66%          ] report.sqlite[2/8] [===============67%          ] report.sqlite[2/8] [================68%         ] report.sqlite[2/8] [================69%         ] report.sqlite[2/8] [================70%         ] report.sqlite[2/8] [================71%         ] report.sqlite[2/8] [=================72%        ] report.sqlite[2/8] [=================73%        ] report.sqlite[2/8] [=================74%        ] report.sqlite[2/8] [==================75%       ] report.sqlite[2/8] [==================76%       ] report.sqlite[2/8] [==================77%       ] report.sqlite[2/8] [==================78%       ] report.sqlite[2/8] [===================79%      ] report.sqlite[2/8] [===================80%      ] report.sqlite[2/8] [===================81%      ] report.sqlite[2/8] [===================82%      ] report.sqlite[2/8] [====================83%     ] report.sqlite[2/8] [====================84%     ] report.sqlite[2/8] [====================85%     ] report.sqlite[2/8] [=====================86%    ] report.sqlite[2/8] [=====================87%    ] report.sqlite[2/8] [=====================88%    ] report.sqlite[2/8] [=====================89%    ] report.sqlite[2/8] [======================90%   ] report.sqlite[2/8] [======================91%   ] report.sqlite[2/8] [======================92%   ] report.sqlite[2/8] [=======================93%  ] report.sqlite[2/8] [=======================94%  ] report.sqlite[2/8] [=======================95%  ] report.sqlite[2/8] [=======================96%  ] report.sqlite[2/8] [========================97% ] report.sqlite[2/8] [========================98% ] report.sqlite[2/8] [========================99% ] report.sqlite[2/8] [========================100%] report.sqlite[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)           Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------
     46.8  191,034,721,452        382  500,090,893.9  500,094,652.0  500,060,570  500,268,444     18,686.9  pthread_cond_timedwait
     46.8  190,998,886,368      1,917   99,634,265.2  100,158,836.0        8,455  100,395,052  6,954,461.2  poll                  
      4.7   19,021,215,816    116,470      163,314.3       15,597.0          395  210,205,060  3,462,391.0  ioctl                 
      1.8    7,368,520,240  3,921,525        1,879.0        1,572.0          501    5,250,541      3,402.5  read                  
      0.0       44,091,905         36    1,224,775.1      210,765.0          188   31,209,716  5,197,987.0  pthread_rwlock_wrlock 
      0.0        6,907,112      1,039        6,647.8        5,037.0        1,264       23,785      4,346.2  munmap                
      0.0        4,617,494        531        8,695.8        7,939.0        1,644       69,425      5,857.9  mmap                  
      0.0        2,056,575         33       62,320.5        9,797.0        5,367    1,352,115    232,492.8  mmap64                
      0.0          962,911         56       17,194.8       13,350.5        4,300       93,213     15,812.8  open64                
      0.0          934,602          9      103,844.7       19,504.0       10,201      656,419    212,381.9  sem_timedwait         
      0.0          788,708          6      131,451.3      132,107.0       12,039      322,913    108,168.6  pthread_mutex_lock    
      0.0          163,802          3       54,600.7       62,889.0       37,993       62,920     14,382.7  pthread_create        
      0.0          158,772         37        4,291.1        2,893.0          785       14,139      3,383.9  fopen                 
      0.0          103,507          6       17,251.2       17,996.0        7,952       24,098      5,500.6  fopen64               
      0.0           67,026         36        1,861.8        1,276.0          743        9,501      1,613.5  fclose                
      0.0           63,878         23        2,777.3          783.0           33        9,960      3,791.2  fflush                
      0.0           36,324         25        1,453.0           40.0           34       35,317      7,055.0  fgets                 
      0.0           25,432         63          403.7          381.0          194          805        163.5  fcntl                 
      0.0           23,721          6        3,953.5        4,406.5        1,225        6,700      1,909.0  open                  
      0.0           20,846        109          191.2           46.0           33        4,865        575.5  fwrite                
      0.0           20,250         10        2,025.0        1,662.0          738        5,873      1,531.9  write                 
      0.0           17,773          2        8,886.5        8,886.5        4,905       12,868      5,630.7  socket                
      0.0           11,606          1       11,606.0       11,606.0       11,606       11,606          0.0  connect               
      0.0           10,724          1       10,724.0       10,724.0       10,724       10,724          0.0  pipe2                 
      0.0            2,890         64           45.2           26.0           24          947        117.0  pthread_mutex_trylock 
      0.0            2,052          1        2,052.0        2,052.0        2,052        2,052          0.0  bind                  
      0.0            2,048          7          292.6          330.0          203          362         69.1  dup                   
      0.0            1,968         13          151.4          223.0           31          317        112.9  putc                  
      0.0              966          1          966.0          966.0          966          966          0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)  Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -----------  --------  --------  -----------  ------------  ----------------------
     73.1   46,665,257,340     34,287  1,361,019.0  58,634.0     1,144  305,445,774   7,246,761.5  cudaFree              
     13.8    8,784,392,521     34,287    256,201.8   3,792.0     1,192  396,367,805   6,447,090.4  cudaMalloc            
     10.1    6,435,145,128      4,843  1,328,751.8  11,693.0     5,143  837,237,404  14,597,262.3  cudaMemcpy            
      3.1    1,982,327,414    630,725      3,142.9   2,977.0     2,547      901,967       3,262.0  cudaLaunchKernel      
      0.0            2,155          1      2,155.0   2,155.0     2,155        2,155           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)   Med (ns)   Min (ns)   Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ---------  ---------  --------  ----------  -----------  ----------------------------------------------------------------------------------------------------
     79.7   30,659,063,288    147,745  207,513.4   10,272.0     2,431   9,848,725    970,471.1  operations::tensor_core_matrix_multiplication_kernel(float *, const float *, const float *, int, inâ€¦
     11.4    4,401,859,136     66,560   66,133.7   35,103.0     3,487     211,777     72,346.8  operations::naive_softmax_kernel(float *, int, int)                                                 
      5.2    2,016,552,536      4,225  477,290.5  280,513.0   267,137   1,358,440    395,180.5  operations::naive_rms_norm_kernel(float *, const float *, int, float)                               
      1.2      462,836,683     66,785    6,930.2    2,368.0     1,215  24,185,557    119,166.8  operations::naive_transpose_kernel(float *, const float *, int, int)                                
      0.8      308,465,319    199,680    1,544.8    1,280.0     1,120       3,776        502.0  extract_head_kernel(float *, const float *, int, int, int, int)                                     
      0.4      151,977,755      2,080   73,066.2   53,952.0     3,104     199,169     69,885.3  operations::multiply_kernel(float *, const float *, int)                                            
      0.3      117,304,085     66,560    1,762.4    1,280.0     1,151       3,968        951.8  causal_mask_and_scale_kernel(float *, int, float)                                                   
      0.3      106,327,294      2,080   51,118.9   36,832.0     3,808     137,952     47,932.4  operations::silu_kernel(float *, long)                                                              
      0.2       88,776,710     66,560    1,333.8    1,248.0     1,120       2,048        202.1  insert_head_kernel(float *, const float *, int, int, int, int)                                      
      0.2       83,292,545      4,160   20,022.2   12,704.0     2,143      56,673     18,739.6  operations::add_kernel(float *, const float *, long)                                                
      0.1       51,709,107      4,160   12,430.1    7,839.5     2,367      43,615     11,729.6  operations::rope_kernel(float *, int, int)                                                          
      0.0          837,827         65   12,889.6    8,896.0     3,296      32,641     10,726.1  operations::embed_kernel(float *, const float *, const int *, int)                                  
      0.0           95,556         65    1,470.1    1,472.0     1,151       2,080        310.3  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count    Avg (ns)      Med (ns)    Min (ns)   Max (ns)    StdDev (ns)             Operation           
 --------  ---------------  -----  ------------  ------------  --------  -----------  ------------  ------------------------------
     96.9    6,350,242,781    296  21,453,522.9  12,370,700.0       448  836,320,358  55,273,176.5  [CUDA memcpy Host-to-Device]  
      3.1      206,475,933  4,547      45,409.3       6,816.0     1,216    7,026,411     198,591.4  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  ---------  -----------  ------------------------------
 60,505.997  4,547    13.307     3.146     0.016  2,101.346       58.763  [CUDA memcpy Device-to-Device]
 32,121.050    296   108.517    67.109     0.000  2,101.346      192.645  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Thu Jan  1 04:13:42 PM KST 2026
