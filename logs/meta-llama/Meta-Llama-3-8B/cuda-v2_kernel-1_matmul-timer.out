make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude -c source/operations.cu -o source/operations.o
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude -c source/llama3_8b.cu -o source/llama3_8b.o
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/main.o -o main
/home/hyoungjo/miniconda3/envs/cuda/bin/nvcc -arch=sm_86 -Xcompiler -Wall,-Wextra -O3 -diag-suppress 177 -Iinclude source/tensor.o source/operations.o source/utils.o source/gpt2.o source/llama3_8b.o source/timer.o -o timer
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Thu Jan  1 03:52:41 PM KST 2026
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/weights.bin
[CUDA][INFO] Starting inference loop
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/0/input_ids.bin
Text 0 | Seq Len: 14
   Median: 296 ms
   IQR:    0 ms (296 to 296)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/2/input_ids.bin
Text 2 | Seq Len: 63
   Median: 529 ms
   IQR:    2.25 ms (527.5 to 529.75)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/3/input_ids.bin
Text 3 | Seq Len: 192
   Median: 1738 ms
   IQR:    286.5 ms (1457.25 to 1743.75)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/13/input_ids.bin
Text 13 | Seq Len: 352
   Median: 2774 ms
   IQR:    18.25 ms (2769.25 to 2787.5)
   3 warmups, 10 iterations
[CUDA][INFO] Loading data from data/meta-llama/Meta-Llama-3-8B/14/input_ids.bin
Text 14 | Seq Len: 713
   Median: 5935.5 ms
   IQR:    378 ms (5925.5 to 6303.5)
   3 warmups, 10 iterations
Generating '/tmp/nsys-report-0e51.qdstrm'
[1/8] [0%                          ] report.nsys-rep[1/8] [0%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [=16%                        ] report.nsys-rep[1/8] [=17%                        ] report.nsys-rep[1/8] [==18%                       ] report.nsys-rep[1/8] [==19%                       ] report.nsys-rep[1/8] [==20%                       ] report.nsys-rep[1/8] [==21%                       ] report.nsys-rep[1/8] [===22%                      ] report.nsys-rep[1/8] [===23%                      ] report.nsys-rep[1/8] [===24%                      ] report.nsys-rep[1/8] [====25%                     ] report.nsys-rep[1/8] [====26%                     ] report.nsys-rep[1/8] [====27%                     ] report.nsys-rep[1/8] [====28%                     ] report.nsys-rep[1/8] [=====29%                    ] report.nsys-rep[1/8] [=====30%                    ] report.nsys-rep[1/8] [=====31%                    ] report.nsys-rep[1/8] [=====32%                    ] report.nsys-rep[1/8] [======33%                   ] report.nsys-rep[1/8] [======34%                   ] report.nsys-rep[1/8] [======35%                   ] report.nsys-rep[1/8] [=======36%                  ] report.nsys-rep[1/8] [=======37%                  ] report.nsys-rep[1/8] [=======38%                  ] report.nsys-rep[1/8] [=======39%                  ] report.nsys-rep[1/8] [========40%                 ] report.nsys-rep[1/8] [========41%                 ] report.nsys-rep[1/8] [========42%                 ] report.nsys-rep[1/8] [=========43%                ] report.nsys-rep[1/8] [=========44%                ] report.nsys-rep[1/8] [=========45%                ] report.nsys-rep[1/8] [=========46%                ] report.nsys-rep[1/8] [==========47%               ] report.nsys-rep[1/8] [==========48%               ] report.nsys-rep[1/8] [==========49%               ] report.nsys-rep[1/8] [===========50%              ] report.nsys-rep[1/8] [===========51%              ] report.nsys-rep[1/8] [===========52%              ] report.nsys-rep[1/8] [===========53%              ] report.nsys-rep[1/8] [============54%             ] report.nsys-rep[1/8] [============55%             ] report.nsys-rep[1/8] [============56%             ] report.nsys-rep[1/8] [============57%             ] report.nsys-rep[1/8] [=============58%            ] report.nsys-rep[1/8] [=============59%            ] report.nsys-rep[1/8] [=============60%            ] report.nsys-rep[1/8] [==============61%           ] report.nsys-rep[1/8] [==============62%           ] report.nsys-rep[1/8] [==============63%           ] report.nsys-rep[1/8] [==============64%           ] report.nsys-rep[1/8] [===============65%          ] report.nsys-rep[1/8] [===============66%          ] report.nsys-rep[1/8] [===============67%          ] report.nsys-rep[1/8] [================68%         ] report.nsys-rep[1/8] [================69%         ] report.nsys-rep[1/8] [================70%         ] report.nsys-rep[1/8] [================71%         ] report.nsys-rep[1/8] [=================72%        ] report.nsys-rep[1/8] [=================73%        ] report.nsys-rep[1/8] [=================74%        ] report.nsys-rep[1/8] [==================75%       ] report.nsys-rep[1/8] [==================76%       ] report.nsys-rep[1/8] [==================77%       ] report.nsys-rep[1/8] [==================78%       ] report.nsys-rep[1/8] [===================79%      ] report.nsys-rep[1/8] [===================80%      ] report.nsys-rep[1/8] [===================81%      ] report.nsys-rep[1/8] [===================82%      ] report.nsys-rep[1/8] [====================83%     ] report.nsys-rep[1/8] [====================84%     ] report.nsys-rep[1/8] [====================85%     ] report.nsys-rep[1/8] [=====================86%    ] report.nsys-rep[1/8] [=====================87%    ] report.nsys-rep[1/8] [=====================88%    ] report.nsys-rep[1/8] [=====================89%    ] report.nsys-rep[1/8] [======================90%   ] report.nsys-rep[1/8] [======================91%   ] report.nsys-rep[1/8] [======================92%   ] report.nsys-rep[1/8] [=======================93%  ] report.nsys-rep[1/8] [=======================94%  ] report.nsys-rep[1/8] [========================100%] report.nsys-rep[1/8] [========================100%] report.nsys-rep
[2/8] [0%                          ] report.sqlite[2/8] [1%                          ] report.sqlite[2/8] [2%                          ] report.sqlite[2/8] [3%                          ] report.sqlite[2/8] [4%                          ] report.sqlite[2/8] [5%                          ] report.sqlite[2/8] [6%                          ] report.sqlite[2/8] [7%                          ] report.sqlite[2/8] [8%                          ] report.sqlite[2/8] [9%                          ] report.sqlite[2/8] [10%                         ] report.sqlite[2/8] [11%                         ] report.sqlite[2/8] [12%                         ] report.sqlite[2/8] [13%                         ] report.sqlite[2/8] [14%                         ] report.sqlite[2/8] [=15%                        ] report.sqlite[2/8] [=16%                        ] report.sqlite[2/8] [=17%                        ] report.sqlite[2/8] [==18%                       ] report.sqlite[2/8] [==19%                       ] report.sqlite[2/8] [==20%                       ] report.sqlite[2/8] [==21%                       ] report.sqlite[2/8] [===22%                      ] report.sqlite[2/8] [===23%                      ] report.sqlite[2/8] [===24%                      ] report.sqlite[2/8] [====25%                     ] report.sqlite[2/8] [====26%                     ] report.sqlite[2/8] [====27%                     ] report.sqlite[2/8] [====28%                     ] report.sqlite[2/8] [=====29%                    ] report.sqlite[2/8] [=====30%                    ] report.sqlite[2/8] [=====31%                    ] report.sqlite[2/8] [=====32%                    ] report.sqlite[2/8] [======33%                   ] report.sqlite[2/8] [======34%                   ] report.sqlite[2/8] [======35%                   ] report.sqlite[2/8] [=======36%                  ] report.sqlite[2/8] [=======37%                  ] report.sqlite[2/8] [=======38%                  ] report.sqlite[2/8] [=======39%                  ] report.sqlite[2/8] [========40%                 ] report.sqlite[2/8] [========41%                 ] report.sqlite[2/8] [========42%                 ] report.sqlite[2/8] [=========43%                ] report.sqlite[2/8] [=========44%                ] report.sqlite[2/8] [=========45%                ] report.sqlite[2/8] [=========46%                ] report.sqlite[2/8] [==========47%               ] report.sqlite[2/8] [==========48%               ] report.sqlite[2/8] [==========49%               ] report.sqlite[2/8] [===========50%              ] report.sqlite[2/8] [===========51%              ] report.sqlite[2/8] [===========52%              ] report.sqlite[2/8] [===========53%              ] report.sqlite[2/8] [============54%             ] report.sqlite[2/8] [============55%             ] report.sqlite[2/8] [============56%             ] report.sqlite[2/8] [============57%             ] report.sqlite[2/8] [=============58%            ] report.sqlite[2/8] [=============59%            ] report.sqlite[2/8] [=============60%            ] report.sqlite[2/8] [==============61%           ] report.sqlite[2/8] [==============62%           ] report.sqlite[2/8] [==============63%           ] report.sqlite[2/8] [==============64%           ] report.sqlite[2/8] [===============65%          ] report.sqlite[2/8] [===============66%          ] report.sqlite[2/8] [===============67%          ] report.sqlite[2/8] [================68%         ] report.sqlite[2/8] [================69%         ] report.sqlite[2/8] [================70%         ] report.sqlite[2/8] [================71%         ] report.sqlite[2/8] [=================72%        ] report.sqlite[2/8] [=================73%        ] report.sqlite[2/8] [=================74%        ] report.sqlite[2/8] [==================75%       ] report.sqlite[2/8] [==================76%       ] report.sqlite[2/8] [==================77%       ] report.sqlite[2/8] [==================78%       ] report.sqlite[2/8] [===================79%      ] report.sqlite[2/8] [===================80%      ] report.sqlite[2/8] [===================81%      ] report.sqlite[2/8] [===================82%      ] report.sqlite[2/8] [====================83%     ] report.sqlite[2/8] [====================84%     ] report.sqlite[2/8] [====================85%     ] report.sqlite[2/8] [=====================86%    ] report.sqlite[2/8] [=====================87%    ] report.sqlite[2/8] [=====================88%    ] report.sqlite[2/8] [=====================89%    ] report.sqlite[2/8] [======================90%   ] report.sqlite[2/8] [======================91%   ] report.sqlite[2/8] [======================92%   ] report.sqlite[2/8] [=======================93%  ] report.sqlite[2/8] [=======================94%  ] report.sqlite[2/8] [=======================95%  ] report.sqlite[2/8] [=======================96%  ] report.sqlite[2/8] [========================97% ] report.sqlite[2/8] [========================98% ] report.sqlite[2/8] [========================99% ] report.sqlite[2/8] [========================100%] report.sqlite[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)           Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------
     46.7  290,553,567,927        581  500,092,199.5  500,093,591.0  500,062,253  501,977,619     79,496.1  pthread_cond_timedwait
     46.6  290,445,935,842      2,910   99,809,599.9  100,157,405.0        8,664  100,362,736  5,647,664.5  poll                  
      5.6   34,861,227,155    116,470      299,315.1       15,859.5          432  219,046,975  5,348,850.6  ioctl                 
      1.1    6,805,107,019  3,921,525        1,735.3        1,589.0          479       29,920        562.0  read                  
      0.0       10,676,098         32      333,628.1      240,251.0          344    1,141,367    350,414.7  pthread_rwlock_wrlock 
      0.0        6,860,495      1,039        6,603.0        4,931.0        1,175      106,750      5,419.7  munmap                
      0.0        5,302,910        531        9,986.6        9,179.0        1,441       72,792      6,911.8  mmap                  
      0.0        2,033,598         33       61,624.2        9,113.0        5,143    1,329,300    228,717.0  mmap64                
      0.0          842,188          7      120,312.6       17,868.0        1,520      689,793    251,752.0  pthread_mutex_lock    
      0.0          663,467         56       11,847.6       11,860.5        3,823       18,561      3,314.8  open64                
      0.0          652,189          9       72,465.4       19,678.0        9,593      441,209    140,580.6  sem_timedwait         
      0.0          165,074          3       55,024.7       62,236.0       36,971       65,867     15,740.0  pthread_create        
      0.0          145,217         37        3,924.8        2,211.0          775       14,217      3,411.9  fopen                 
      0.0          105,774          6       17,629.0       17,925.0       10,956       23,053      3,979.3  fopen64               
      0.0           66,647         36        1,851.3        1,129.5          678        9,907      1,790.3  fclose                
      0.0           58,847         23        2,558.6          884.0           36        9,325      3,357.7  fflush                
      0.0           35,336         25        1,413.4           38.0           34       34,346      6,861.0  fgets                 
      0.0           24,271          6        4,045.2        4,500.0        1,164        6,810      2,135.8  open                  
      0.0           24,095         63          382.5          321.0          192          864        162.7  fcntl                 
      0.0           20,367        109          186.9           43.0           34        3,753        497.1  fwrite                
      0.0           18,048          2        9,024.0        9,024.0        4,741       13,307      6,057.1  socket                
      0.0           17,941         10        1,794.1        2,021.0          600        3,092        947.8  write                 
      0.0           12,381          1       12,381.0       12,381.0       12,381       12,381          0.0  connect               
      0.0            9,722          1        9,722.0        9,722.0        9,722        9,722          0.0  pipe2                 
      0.0            3,335         64           52.1           28.0           26        1,095        135.4  pthread_mutex_trylock 
      0.0            2,400         13          184.6          236.0           32          525        157.3  putc                  
      0.0            2,001          7          285.9          285.0          220          436         77.2  dup                   
      0.0            1,859          1        1,859.0        1,859.0        1,859        1,859          0.0  bind                  
      0.0              907          1          907.0          907.0          907          907          0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)  Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -----------  --------  --------  -----------  ------------  ----------------------
     88.2  144,864,335,920     34,287  4,225,051.4  59,384.0     1,125  406,324,697  19,370,671.6  cudaFree              
      6.5   10,701,515,522     34,287    312,115.8   4,809.0     1,207  388,926,954   7,185,554.7  cudaMalloc            
      4.0    6,596,998,922      4,843  1,362,172.0  13,900.0     4,795  916,430,214  15,607,854.5  cudaMemcpy            
      1.2    1,990,952,944    630,725      3,156.6   2,981.0     2,549    1,174,153       3,748.1  cudaLaunchKernel      
      0.0            2,175          1      2,175.0   2,175.0     2,175        2,175           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)   Med (ns)   Min (ns)   Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ---------  ---------  --------  ----------  -----------  ----------------------------------------------------------------------------------------------------
     94.0  115,350,670,675    147,745  780,741.6   13,216.0     3,040  39,078,600  4,049,102.5  operations::matrix_multiplication_kernel(float *, const float *, const float *, int, int, int, bool)
      3.3    4,105,906,258     66,560   61,687.3   34,752.0     3,487     186,913     65,049.5  operations::naive_softmax_kernel(float *, int, int)                                                 
      1.6    1,947,909,276      4,225  461,043.6  280,386.0   267,266   1,244,009    366,551.7  operations::naive_rms_norm_kernel(float *, const float *, int, float)                               
      0.4      452,514,979     66,785    6,775.7    2,336.0     1,215  24,188,547    119,173.3  operations::naive_transpose_kernel(float *, const float *, int, int)                                
      0.2      302,722,060    199,680    1,516.0    1,248.0     1,120       3,584        468.2  extract_head_kernel(float *, const float *, int, int, int, int)                                     
      0.1      152,774,107      2,080   73,449.1   54,112.0     3,424     199,906     70,249.8  operations::multiply_kernel(float *, const float *, int)                                            
      0.1      111,583,529     66,560    1,676.4    1,248.0     1,151       3,489        808.0  causal_mask_and_scale_kernel(float *, int, float)                                                   
      0.1      104,675,546      2,080   50,324.8   35,617.0     3,712     135,521     47,638.2  operations::silu_kernel(float *, long)                                                              
      0.1       85,871,763     66,560    1,290.1    1,248.0     1,151       2,273        143.6  insert_head_kernel(float *, const float *, int, int, int, int)                                      
      0.1       80,828,211      4,160   19,429.9   12,304.5     2,400      53,696     18,088.9  operations::add_kernel(float *, const float *, long)                                                
      0.0       48,643,707      4,160   11,693.2    7,680.0     2,367      39,712     10,726.3  operations::rope_kernel(float *, int, int)                                                          
      0.0          829,670         65   12,764.2    8,832.0     3,328      31,968     10,520.1  operations::embed_kernel(float *, const float *, const int *, int)                                  
      0.0           93,283         65    1,435.1    1,471.0     1,151       1,952        267.0  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count    Avg (ns)      Med (ns)    Min (ns)   Max (ns)    StdDev (ns)             Operation           
 --------  ---------------  -----  ------------  ------------  --------  -----------  ------------  ------------------------------
     96.9    6,500,162,774    296  21,960,009.4  12,393,381.0       448  915,447,864  59,450,086.2  [CUDA memcpy Host-to-Device]  
      3.1      206,185,212  4,547      45,345.3       6,784.0     1,215    7,028,249     198,577.4  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  ---------  -----------  ------------------------------
 60,505.997  4,547    13.307     3.146     0.016  2,101.346       58.763  [CUDA memcpy Device-to-Device]
 32,121.050    296   108.517    67.109     0.000  2,101.346      192.645  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Thu Jan  1 03:58:32 PM KST 2026
