make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Sat Dec 20 07:24:13 PM KST 2025
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/weights.bin
[CUDA][INFO] Starting inference loop [0, 15)
[CUDA][INFO] Loading data from data/0/input_ids.bin
Text 0 | Seq Len: 13
   Median: 12626.5 μs
   IQR:    102.5 μs (12618 to 12720.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/1/input_ids.bin
Text 1 | Seq Len: 17
   Median: 12870 μs
   IQR:    22.25 μs (12856.2 to 12878.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/2/input_ids.bin
Text 2 | Seq Len: 64
   Median: 14389.5 μs
   IQR:    48.75 μs (14374.2 to 14423)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/3/input_ids.bin
Text 3 | Seq Len: 200
   Median: 23908 μs
   IQR:    436 μs (23696.8 to 24132.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/4/input_ids.bin
Text 4 | Seq Len: 301
   Median: 32537 μs
   IQR:    291.5 μs (32462.8 to 32754.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/5/input_ids.bin
Text 5 | Seq Len: 305
   Median: 32962.5 μs
   IQR:    297.75 μs (32865.5 to 33163.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/6/input_ids.bin
Text 6 | Seq Len: 320
   Median: 33113.5 μs
   IQR:    383.75 μs (32989.2 to 33373)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/7/input_ids.bin
Text 7 | Seq Len: 332
   Median: 34635.5 μs
   IQR:    233.25 μs (34512.5 to 34745.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/8/input_ids.bin
Text 8 | Seq Len: 342
   Median: 38828.5 μs
   IQR:    584.25 μs (38509.2 to 39093.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/9/input_ids.bin
Text 9 | Seq Len: 344
   Median: 38923.5 μs
   IQR:    292.25 μs (38733.8 to 39026)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/10/input_ids.bin
Text 10 | Seq Len: 363
   Median: 41062.5 μs
   IQR:    192.75 μs (41021.2 to 41214)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/11/input_ids.bin
Text 11 | Seq Len: 364
   Median: 39753.5 μs
   IQR:    216.25 μs (39649.2 to 39865.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/12/input_ids.bin
Text 12 | Seq Len: 367
   Median: 41278 μs
   IQR:    378.25 μs (41101.8 to 41480)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/13/input_ids.bin
Text 13 | Seq Len: 371
   Median: 41446 μs
   IQR:    441 μs (41255 to 41696)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/14/input_ids.bin
Text 14 | Seq Len: 732
   Median: 67668 μs
   IQR:    564.75 μs (67442.8 to 68007.5)
   5 warmups, 20 iterations
Generating '/tmp/nsys-report-1d01.qdstrm'
[1/8] [0%                          ] report.nsys-rep[1/8] [0%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [==18%                       ] report.nsys-rep[1/8] [=16%                        ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [6%                          ] report.nsys-rep[1/8] [7%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [12%                         ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [14%                         ] report.nsys-rep[1/8] [=15%                        ] report.nsys-rep[1/8] [=16%                        ] report.nsys-rep[1/8] [=17%                        ] report.nsys-rep[1/8] [==18%                       ] report.nsys-rep[1/8] [==19%                       ] report.nsys-rep[1/8] [==20%                       ] report.nsys-rep[1/8] [==21%                       ] report.nsys-rep[1/8] [===22%                      ] report.nsys-rep[1/8] [===24%                      ] report.nsys-rep[1/8] [====25%                     ] report.nsys-rep[1/8] [====26%                     ] report.nsys-rep[1/8] [====27%                     ] report.nsys-rep[1/8] [====28%                     ] report.nsys-rep[1/8] [=====29%                    ] report.nsys-rep[1/8] [=====30%                    ] report.nsys-rep[1/8] [=====31%                    ] report.nsys-rep[1/8] [=====32%                    ] report.nsys-rep[1/8] [======33%                   ] report.nsys-rep[1/8] [======34%                   ] report.nsys-rep[1/8] [======35%                   ] report.nsys-rep[1/8] [=======36%                  ] report.nsys-rep[1/8] [=======37%                  ] report.nsys-rep[1/8] [=======39%                  ] report.nsys-rep[1/8] [========40%                 ] report.nsys-rep[1/8] [========41%                 ] report.nsys-rep[1/8] [========42%                 ] report.nsys-rep[1/8] [=========43%                ] report.nsys-rep[1/8] [=========44%                ] report.nsys-rep[1/8] [=========45%                ] report.nsys-rep[1/8] [=========46%                ] report.nsys-rep[1/8] [==========47%               ] report.nsys-rep[1/8] [==========48%               ] report.nsys-rep[1/8] [==========49%               ] report.nsys-rep[1/8] [===========51%              ] report.nsys-rep[1/8] [===========52%              ] report.nsys-rep[1/8] [===========53%              ] report.nsys-rep[1/8] [============54%             ] report.nsys-rep[1/8] [============55%             ] report.nsys-rep[1/8] [============56%             ] report.nsys-rep[1/8] [============57%             ] report.nsys-rep[1/8] [=============58%            ] report.nsys-rep[1/8] [=============59%            ] report.nsys-rep[1/8] [=============60%            ] report.nsys-rep[1/8] [==============61%           ] report.nsys-rep[1/8] [==============62%           ] report.nsys-rep[1/8] [==============64%           ] report.nsys-rep[1/8] [===============65%          ] report.nsys-rep[1/8] [===============66%          ] report.nsys-rep[1/8] [===============67%          ] report.nsys-rep[1/8] [================68%         ] report.nsys-rep[1/8] [================69%         ] report.nsys-rep[1/8] [================70%         ] report.nsys-rep[1/8] [================71%         ] report.nsys-rep[1/8] [=================72%        ] report.nsys-rep[1/8] [=================73%        ] report.nsys-rep[1/8] [==================75%       ] report.nsys-rep[1/8] [==================76%       ] report.nsys-rep[1/8] [==================77%       ] report.nsys-rep[1/8] [==================78%       ] report.nsys-rep[1/8] [===================79%      ] report.nsys-rep[1/8] [===================80%      ] report.nsys-rep[1/8] [===================81%      ] report.nsys-rep[1/8] [========================100%] report.nsys-rep[1/8] [========================100%] report.nsys-rep
[2/8] [0%                          ] report.sqlite[2/8] [1%                          ] report.sqlite[2/8] [2%                          ] report.sqlite[2/8] [3%                          ] report.sqlite[2/8] [4%                          ] report.sqlite[2/8] [5%                          ] report.sqlite[2/8] [6%                          ] report.sqlite[2/8] [7%                          ] report.sqlite[2/8] [8%                          ] report.sqlite[2/8] [9%                          ] report.sqlite[2/8] [10%                         ] report.sqlite[2/8] [11%                         ] report.sqlite[2/8] [12%                         ] report.sqlite[2/8] [13%                         ] report.sqlite[2/8] [14%                         ] report.sqlite[2/8] [=15%                        ] report.sqlite[2/8] [=16%                        ] report.sqlite[2/8] [=17%                        ] report.sqlite[2/8] [==18%                       ] report.sqlite[2/8] [==19%                       ] report.sqlite[2/8] [==20%                       ] report.sqlite[2/8] [==21%                       ] report.sqlite[2/8] [===22%                      ] report.sqlite[2/8] [===23%                      ] report.sqlite[2/8] [===24%                      ] report.sqlite[2/8] [====25%                     ] report.sqlite[2/8] [====26%                     ] report.sqlite[2/8] [====27%                     ] report.sqlite[2/8] [====28%                     ] report.sqlite[2/8] [=====29%                    ] report.sqlite[2/8] [=====30%                    ] report.sqlite[2/8] [=====31%                    ] report.sqlite[2/8] [=====32%                    ] report.sqlite[2/8] [======33%                   ] report.sqlite[2/8] [======34%                   ] report.sqlite[2/8] [======35%                   ] report.sqlite[2/8] [=======36%                  ] report.sqlite[2/8] [=======37%                  ] report.sqlite[2/8] [=======38%                  ] report.sqlite[2/8] [=======39%                  ] report.sqlite[2/8] [========40%                 ] report.sqlite[2/8] [========41%                 ] report.sqlite[2/8] [========42%                 ] report.sqlite[2/8] [=========43%                ] report.sqlite[2/8] [=========44%                ] report.sqlite[2/8] [=========45%                ] report.sqlite[2/8] [=========46%                ] report.sqlite[2/8] [==========47%               ] report.sqlite[2/8] [==========48%               ] report.sqlite[2/8] [==========49%               ] report.sqlite[2/8] [===========50%              ] report.sqlite[2/8] [===========51%              ] report.sqlite[2/8] [===========52%              ] report.sqlite[2/8] [===========53%              ] report.sqlite[2/8] [============54%             ] report.sqlite[2/8] [============55%             ] report.sqlite[2/8] [============56%             ] report.sqlite[2/8] [============57%             ] report.sqlite[2/8] [=============58%            ] report.sqlite[2/8] [=============59%            ] report.sqlite[2/8] [=============60%            ] report.sqlite[2/8] [==============61%           ] report.sqlite[2/8] [==============62%           ] report.sqlite[2/8] [==============63%           ] report.sqlite[2/8] [==============64%           ] report.sqlite[2/8] [===============65%          ] report.sqlite[2/8] [===============66%          ] report.sqlite[2/8] [===============67%          ] report.sqlite[2/8] [================68%         ] report.sqlite[2/8] [================69%         ] report.sqlite[2/8] [================70%         ] report.sqlite[2/8] [================71%         ] report.sqlite[2/8] [=================72%        ] report.sqlite[2/8] [=================73%        ] report.sqlite[2/8] [=================74%        ] report.sqlite[2/8] [==================75%       ] report.sqlite[2/8] [==================76%       ] report.sqlite[2/8] [==================77%       ] report.sqlite[2/8] [==================78%       ] report.sqlite[2/8] [===================79%      ] report.sqlite[2/8] [===================80%      ] report.sqlite[2/8] [===================81%      ] report.sqlite[2/8] [===================82%      ] report.sqlite[2/8] [====================83%     ] report.sqlite[2/8] [====================84%     ] report.sqlite[2/8] [====================85%     ] report.sqlite[2/8] [=====================86%    ] report.sqlite[2/8] [=====================87%    ] report.sqlite[2/8] [=====================88%    ] report.sqlite[2/8] [=====================89%    ] report.sqlite[2/8] [======================90%   ] report.sqlite[2/8] [======================91%   ] report.sqlite[2/8] [======================92%   ] report.sqlite[2/8] [=======================93%  ] report.sqlite[2/8] [=======================94%  ] report.sqlite[2/8] [=======================95%  ] report.sqlite[2/8] [=======================96%  ] report.sqlite[2/8] [========================97% ] report.sqlite[2/8] [========================98% ] report.sqlite[2/8] [========================99% ] report.sqlite[2/8] [========================100%] report.sqlite[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     44.6   15,120,777,138        161   93,917,870.4  100,131,987.0        8,613  100,210,859  23,321,176.6  poll                  
     44.2   15,002,618,669         30  500,087,289.0  500,090,715.5  500,062,295  500,110,676      12,527.4  pthread_cond_timedwait
     10.6    3,607,939,733    157,012       22,978.8       14,557.0          388   20,614,238      60,992.6  ioctl                 
      0.5      180,627,410     79,647        2,267.8        2,241.0          465       21,371         404.4  read                  
      0.1       17,711,991         28      632,571.1      429,785.5       22,889    2,553,111     604,162.5  pthread_rwlock_wrlock 
      0.0        1,944,682         33       58,929.8       10,936.0        5,467    1,225,340     210,539.0  mmap64                
      0.0          672,588         56       12,010.5       11,788.5        4,174       36,258       4,407.6  open64                
      0.0          507,878          9       56,430.9       19,758.0        9,517      300,172      94,619.4  sem_timedwait         
      0.0          371,410         44        8,441.1        8,122.0        2,295       23,744       4,463.3  munmap                
      0.0          292,954         33        8,877.4        7,353.0        1,719       60,674       9,858.9  mmap                  
      0.0          198,125         16       12,382.8       12,176.5        7,012       18,233       2,979.8  fopen64               
      0.0          150,237         37        4,060.5        2,229.0          847       14,752       3,615.6  fopen                 
      0.0          147,791          3       49,263.7       54,724.0       32,158       60,909      15,133.3  pthread_create        
      0.0          145,074          4       36,268.5       33,649.0       29,663       48,113       8,284.2  pthread_mutex_lock    
      0.0          120,132         43        2,793.8        1,050.0           49        8,465       2,822.7  fflush                
      0.0           81,597         46        1,773.8        1,361.5          706        6,791       1,110.7  fclose                
      0.0           38,540        321          120.1           44.0           34        3,573         317.1  fwrite                
      0.0           35,057         25        1,402.3           38.0           36       34,033       6,798.1  fgets                 
      0.0           27,225          6        4,537.5        4,801.0        1,308        8,240       2,635.4  open                  
      0.0           24,919         63          395.5          393.0          183          846         159.4  fcntl                 
      0.0           16,788          2        8,394.0        8,394.0        4,947       11,841       4,874.8  socket                
      0.0           14,987         10        1,498.7        1,457.0          650        2,509         688.3  write                 
      0.0           11,688          1       11,688.0       11,688.0       11,688       11,688           0.0  connect               
      0.0            9,529          1        9,529.0        9,529.0        9,529        9,529           0.0  pipe2                 
      0.0            4,292         64           67.1           38.0           37        1,356         169.5  pthread_mutex_trylock 
      0.0            3,811         33          115.5          152.0           31          256          72.9  putc                  
      0.0            2,848          1        2,848.0        2,848.0        2,848        2,848           0.0  bind                  
      0.0            2,040          7          291.4          320.0          217          364          62.8  dup                   
      0.0            1,039          1        1,039.0        1,039.0        1,039        1,039           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)  Min (ns)   Max (ns)   StdDev (ns)           Name         
 --------  ---------------  ---------  ---------  --------  --------  ----------  -----------  ----------------------
     70.1    8,910,666,997     59,939  148,662.3   2,603.0       978   4,078,181    317,076.0  cudaFree              
     14.7    1,869,506,589    546,001    3,424.0   3,232.0     2,584   2,592,480      4,622.2  cudaLaunchKernel      
     13.6    1,733,445,581     59,939   28,920.2   2,386.0     1,194  69,499,060    285,918.2  cudaMalloc            
      1.6      199,871,039      9,313   21,461.5   9,654.0     3,476  34,000,063    457,152.6  cudaMemcpy            
      0.0            3,728          1    3,728.0   3,728.0     3,728       3,728          0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  ---------  -----------  ----------------------------------------------------------------------------------------------------
     50.1    4,562,147,249    126,375  36,100.1   8,224.0     2,367    358,018     70,079.1  operations::tensor_core_matrix_multiplication_kernel(float *, const float *, const float *, int, in…
     36.2    3,301,120,335     54,000  61,131.9  60,544.0     3,200    173,601     37,460.9  operations::naive_softmax_kernel(float *, int, int)                                                 
      6.2      567,690,822      9,375  60,553.7  60,096.0    54,528     77,377      3,426.9  operations::naive_layer_norm_kernel(float *, const float *, const float *, int, float)              
      2.3      207,727,786    162,000   1,282.3   1,248.0     1,120      2,720        156.8  extract_head_kernel(float *, const float *, int, int, int, int, int)                                
      1.4      125,671,587     18,000   6,981.8   4,448.0     1,503     33,120      5,517.7  operations::add_bias_kernel(float *, const float *, int, long)                                      
      1.3      118,580,521     54,001   2,195.9   2,240.0     1,151  1,294,249      5,578.5  operations::naive_transpose_kernel(float *, const float *, int, int)                                
      0.9       83,401,516     54,000   1,544.5   1,504.0     1,120      3,424        433.3  causal_mask_and_scale_kernel(float *, int, float)                                                   
      0.7       64,184,037     54,000   1,188.6   1,184.0     1,088      1,888         54.9  insert_head_kernel(float *, const float *, int, int, int, int)                                      
      0.4       40,302,411      4,500   8,956.1   8,800.0     1,632     32,225      6,743.8  operations::gelu_kernel(float *, long)                                                              
      0.4       35,678,771      9,000   3,964.3   4,128.0     1,407      8,896      1,599.3  operations::add_kernel(float *, const float *, long)                                                
      0.0        1,937,194        375   5,165.9   5,569.0     2,047      9,729      1,826.9  operations::embed_kernel(float *, const float *, const float *, const int *, int)                   
      0.0          422,501        375   1,126.7   1,120.0     1,120      1,248         16.7  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)   Max (ns)   StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  ----------  -----------  ------------------------------
     80.3      106,340,984    164  648,420.6     673.0       416  33,655,823  3,361,416.4  [CUDA memcpy Host-to-Device]  
     19.7       26,026,223  9,149    2,844.7   2,240.0     1,120     518,756      8,105.4  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  8,826.741  9,149     0.965     1.020     0.003   154.390        2.381  [CUDA memcpy Device-to-Device]
    652.166    164     3.977     0.003     0.000   154.390       17.141  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Sat Dec 20 07:24:51 PM KST 2025
