make -C cuda
make[1]: Entering directory '/home/hyoungjo/transformer-cuda/cuda'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/home/hyoungjo/transformer-cuda/cuda'
[SLURM][INFO] Run started on baram at Sat Dec 20 08:21:17 PM KST 2025
[CUDA][INFO] Loading model weights...
[CUDA][INFO] Loading data from data/weights.bin
[CUDA][INFO] Starting inference loop [0, 15)
[CUDA][INFO] Loading data from data/0/input_ids.bin
Text 0 | Seq Len: 13
   Median: 7760.5 μs
   IQR:    5.25 μs (7757.75 to 7763)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/1/input_ids.bin
Text 1 | Seq Len: 17
   Median: 7540.5 μs
   IQR:    9.25 μs (7537.75 to 7547)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/2/input_ids.bin
Text 2 | Seq Len: 64
   Median: 7675 μs
   IQR:    92.25 μs (7671.75 to 7764)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/3/input_ids.bin
Text 3 | Seq Len: 200
   Median: 9002.5 μs
   IQR:    141 μs (8983.5 to 9124.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/4/input_ids.bin
Text 4 | Seq Len: 301
   Median: 11311 μs
   IQR:    101 μs (11282 to 11383)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/5/input_ids.bin
Text 5 | Seq Len: 305
   Median: 11294.5 μs
   IQR:    99.5 μs (11269.8 to 11369.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/6/input_ids.bin
Text 6 | Seq Len: 320
   Median: 11315.5 μs
   IQR:    41 μs (11307.2 to 11348.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/7/input_ids.bin
Text 7 | Seq Len: 332
   Median: 12658.5 μs
   IQR:    111.75 μs (12622.8 to 12734.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/8/input_ids.bin
Text 8 | Seq Len: 342
   Median: 13251 μs
   IQR:    57.5 μs (13230.8 to 13288.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/9/input_ids.bin
Text 9 | Seq Len: 344
   Median: 13270.5 μs
   IQR:    64.75 μs (13231 to 13295.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/10/input_ids.bin
Text 10 | Seq Len: 363
   Median: 13624.5 μs
   IQR:    70.25 μs (13598.2 to 13668.5)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/11/input_ids.bin
Text 11 | Seq Len: 364
   Median: 13587 μs
   IQR:    72.25 μs (13565 to 13637.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/12/input_ids.bin
Text 12 | Seq Len: 367
   Median: 13638.5 μs
   IQR:    29.5 μs (13622.2 to 13651.8)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/13/input_ids.bin
Text 13 | Seq Len: 371
   Median: 13636.5 μs
   IQR:    26.75 μs (13620.5 to 13647.2)
   5 warmups, 20 iterations
[CUDA][INFO] Loading data from data/14/input_ids.bin
Text 14 | Seq Len: 732
   Median: 23592.5 μs
   IQR:    100.75 μs (23548 to 23648.8)
   5 warmups, 20 iterations
Generating '/tmp/nsys-report-813d.qdstrm'
[1/8] [0%                          ] report.nsys-rep[1/8] [0%                          ] report.nsys-rep[1/8] [8%                          ] report.nsys-rep[1/8] [5%                          ] report.nsys-rep[1/8] [13%                         ] report.nsys-rep[1/8] [11%                         ] report.nsys-rep[1/8] [10%                         ] report.nsys-rep[1/8] [9%                          ] report.nsys-rep[1/8] [=17%                        ] report.nsys-rep[1/8] [====25%                     ] report.nsys-rep[1/8] [======33%                   ] report.nsys-rep[1/8] [========40%                 ] report.nsys-rep[1/8] [=========46%                ] report.nsys-rep[1/8] [===========52%              ] report.nsys-rep[1/8] [=============58%            ] report.nsys-rep[1/8] [===============65%          ] report.nsys-rep[1/8] [================71%         ] report.nsys-rep[1/8] [==================77%       ] report.nsys-rep[1/8] [====================83%     ] report.nsys-rep[1/8] [====================85%     ] report.nsys-rep[1/8] [========================100%] report.nsys-rep[1/8] [========================100%] report.nsys-rep
[2/8] [0%                          ] report.sqlite[2/8] [1%                          ] report.sqlite[2/8] [2%                          ] report.sqlite[2/8] [3%                          ] report.sqlite[2/8] [4%                          ] report.sqlite[2/8] [5%                          ] report.sqlite[2/8] [6%                          ] report.sqlite[2/8] [7%                          ] report.sqlite[2/8] [8%                          ] report.sqlite[2/8] [9%                          ] report.sqlite[2/8] [10%                         ] report.sqlite[2/8] [11%                         ] report.sqlite[2/8] [12%                         ] report.sqlite[2/8] [13%                         ] report.sqlite[2/8] [14%                         ] report.sqlite[2/8] [=15%                        ] report.sqlite[2/8] [=16%                        ] report.sqlite[2/8] [=17%                        ] report.sqlite[2/8] [==18%                       ] report.sqlite[2/8] [==19%                       ] report.sqlite[2/8] [==20%                       ] report.sqlite[2/8] [==21%                       ] report.sqlite[2/8] [===22%                      ] report.sqlite[2/8] [===23%                      ] report.sqlite[2/8] [===24%                      ] report.sqlite[2/8] [====25%                     ] report.sqlite[2/8] [====26%                     ] report.sqlite[2/8] [====27%                     ] report.sqlite[2/8] [====28%                     ] report.sqlite[2/8] [=====29%                    ] report.sqlite[2/8] [=====30%                    ] report.sqlite[2/8] [=====31%                    ] report.sqlite[2/8] [=====32%                    ] report.sqlite[2/8] [======33%                   ] report.sqlite[2/8] [======34%                   ] report.sqlite[2/8] [======35%                   ] report.sqlite[2/8] [=======36%                  ] report.sqlite[2/8] [=======37%                  ] report.sqlite[2/8] [=======38%                  ] report.sqlite[2/8] [=======39%                  ] report.sqlite[2/8] [========40%                 ] report.sqlite[2/8] [========41%                 ] report.sqlite[2/8] [========42%                 ] report.sqlite[2/8] [=========43%                ] report.sqlite[2/8] [=========44%                ] report.sqlite[2/8] [=========45%                ] report.sqlite[2/8] [=========46%                ] report.sqlite[2/8] [==========47%               ] report.sqlite[2/8] [==========48%               ] report.sqlite[2/8] [==========49%               ] report.sqlite[2/8] [===========50%              ] report.sqlite[2/8] [===========51%              ] report.sqlite[2/8] [===========52%              ] report.sqlite[2/8] [===========53%              ] report.sqlite[2/8] [============54%             ] report.sqlite[2/8] [============55%             ] report.sqlite[2/8] [============56%             ] report.sqlite[2/8] [============57%             ] report.sqlite[2/8] [=============58%            ] report.sqlite[2/8] [=============59%            ] report.sqlite[2/8] [=============60%            ] report.sqlite[2/8] [==============61%           ] report.sqlite[2/8] [==============62%           ] report.sqlite[2/8] [==============63%           ] report.sqlite[2/8] [==============64%           ] report.sqlite[2/8] [===============65%          ] report.sqlite[2/8] [===============66%          ] report.sqlite[2/8] [===============67%          ] report.sqlite[2/8] [================68%         ] report.sqlite[2/8] [================69%         ] report.sqlite[2/8] [================70%         ] report.sqlite[2/8] [================71%         ] report.sqlite[2/8] [=================72%        ] report.sqlite[2/8] [=================73%        ] report.sqlite[2/8] [=================74%        ] report.sqlite[2/8] [==================75%       ] report.sqlite[2/8] [==================76%       ] report.sqlite[2/8] [==================77%       ] report.sqlite[2/8] [==================78%       ] report.sqlite[2/8] [===================79%      ] report.sqlite[2/8] [===================80%      ] report.sqlite[2/8] [===================81%      ] report.sqlite[2/8] [===================82%      ] report.sqlite[2/8] [====================83%     ] report.sqlite[2/8] [====================84%     ] report.sqlite[2/8] [====================85%     ] report.sqlite[2/8] [=====================86%    ] report.sqlite[2/8] [=====================87%    ] report.sqlite[2/8] [=====================88%    ] report.sqlite[2/8] [=====================89%    ] report.sqlite[2/8] [======================90%   ] report.sqlite[2/8] [======================91%   ] report.sqlite[2/8] [======================92%   ] report.sqlite[2/8] [=======================93%  ] report.sqlite[2/8] [=======================94%  ] report.sqlite[2/8] [=======================95%  ] report.sqlite[2/8] [=======================96%  ] report.sqlite[2/8] [========================97% ] report.sqlite[2/8] [========================98% ] report.sqlite[2/8] [========================99% ] report.sqlite[2/8] [========================100%] report.sqlite[2/8] [========================100%] report.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     46.3    7,711,609,729         87   88,639,192.3  100,151,436.0        8,720  100,171,078  30,825,194.2  poll                  
     45.0    7,501,322,588         15  500,088,172.5  500,092,509.0  500,067,092  500,111,879      12,642.1  pthread_cond_timedwait
      7.5    1,254,685,351     11,118      112,851.7       14,673.0          574  110,977,056   2,902,596.1  ioctl                 
      1.1      182,936,414     79,647        2,296.8        2,271.0          607       18,728         408.8  read                  
      0.0        2,530,380         33       76,678.2       13,347.0        8,087    1,568,681     269,630.6  mmap64                
      0.0        1,188,139          9      132,015.4      140,312.0       26,769      417,943     123,644.1  sem_timedwait         
      0.0          795,373         56       14,203.1       14,500.0        5,507       22,058       3,648.7  open64                
      0.0          534,449          1      534,449.0      534,449.0      534,449      534,449           0.0  pthread_rwlock_wrlock 
      0.0          328,813         34        9,671.0        6,192.0        2,556       87,731      14,183.9  mmap                  
      0.0          327,426         47        6,966.5        7,654.0        1,875       17,441       3,201.6  munmap                
      0.0          196,502         37        5,310.9        3,488.0        1,425       17,189       3,933.7  fopen                 
      0.0          184,063          3       61,354.3       61,620.0       49,494       72,949      11,729.8  pthread_create        
      0.0          146,605         16        9,162.8        9,046.5        6,791       12,656       1,533.3  fopen64               
      0.0           99,799         43        2,320.9          901.0           31        7,786       2,394.6  fflush                
      0.0           87,636         46        1,905.1        1,806.5          974        6,116         738.8  fclose                
      0.0           47,860          1       47,860.0       47,860.0       47,860       47,860           0.0  pthread_mutex_lock    
      0.0           47,736         25        1,909.4           58.0           55       46,182       9,223.5  fgets                 
      0.0           35,471         63          563.0          534.0          280        1,041         187.2  fcntl                 
      0.0           30,631        321           95.4           42.0           33        3,144         239.7  fwrite                
      0.0           29,503         10        2,950.3        2,058.5          877       12,815       3,571.1  write                 
      0.0           29,500          6        4,916.7        5,114.0        1,822        7,656       2,332.8  open                  
      0.0           19,920          2        9,960.0        9,960.0        5,724       14,196       5,990.6  socket                
      0.0           13,086          1       13,086.0       13,086.0       13,086       13,086           0.0  connect               
      0.0           10,772          1       10,772.0       10,772.0       10,772       10,772           0.0  pipe2                 
      0.0            3,417         33          103.5          104.0           33          216          61.0  putc                  
      0.0            3,067         64           47.9           24.0           23          949         119.1  pthread_mutex_trylock 
      0.0            2,991          7          427.3          442.0          328          538          87.5  dup                   
      0.0            2,631          1        2,631.0        2,631.0        2,631        2,631           0.0  bind                  
      0.0            1,196          1        1,196.0        1,196.0        1,196        1,196           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)  Min (ns)   Max (ns)    StdDev (ns)           Name         
 --------  ---------------  ---------  -----------  --------  --------  -----------  -----------  ----------------------
     78.4    4,378,140,400      3,689  1,186,809.5  59,687.0       895  179,594,967  4,529,156.1  cudaFree              
     14.7      820,332,859      3,689    222,372.7   3,573.0       957  205,358,573  5,746,762.8  cudaMalloc            
      3.7      205,019,994     64,501      3,178.6   3,074.0     2,588      561,808      2,469.2  cudaLaunchKernel      
      3.3      182,571,380      9,313     19,603.9   4,533.0     3,350   59,863,441    685,714.6  cudaMemcpy            
      0.0            2,889          1      2,889.0   2,889.0     2,889        2,889          0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     76.9    3,289,744,450     18,375  179,033.7  175,423.0    77,184   371,774     99,704.5  operations::tensor_core_matrix_multiplication_kernel(float *, const float *, const float *, int, in…
     17.3      741,126,711      4,500  164,694.8  171,391.0    10,624   652,573    142,364.7  flash_attention_warp_kernel(float *, const float *, int, int, int)                                  
      3.0      127,220,179     18,000    7,067.8    4,448.0     1,536    33,440      5,531.8  operations::add_bias_kernel(float *, const float *, int, long)                                      
      1.0       40,700,561      9,375    4,341.4    4,224.0     3,232     8,192        878.3  operations::layer_norm_kernel(float *, const float *, const float *, int, float)                    
      0.9       40,494,083      4,500    8,998.7    8,800.0     1,664    32,512      6,790.6  operations::gelu_kernel(float *, long)                                                              
      0.9       36,374,404      9,000    4,041.6    4,192.0     1,439     9,184      1,649.8  operations::add_kernel(float *, const float *, long)                                                
      0.0        1,951,355        375    5,203.6    5,600.0     2,048    10,144      1,869.3  operations::embed_kernel(float *, const float *, const float *, const int *, int)                   
      0.0          576,605          1  576,605.0  576,605.0   576,605   576,605          0.0  operations::transpose_kernel(float *, const float *, int, int)                                      
      0.0          426,495        375    1,137.3    1,120.0     1,119     1,217         26.9  extract_last_token_kernel(float *, const float *, int, int)                                         

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)   Max (ns)   StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  ----------  -----------  ------------------------------
     84.4      129,470,674    164  789,455.3     673.0       448  59,448,350  5,086,477.6  [CUDA memcpy Host-to-Device]  
     15.6       23,913,116  9,149    2,613.7   2,048.0     1,120     523,037      7,927.2  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  8,826.741  9,149     0.965     1.020     0.003   154.390        2.381  [CUDA memcpy Device-to-Device]
    652.166    164     3.977     0.003     0.000   154.390       17.141  [CUDA memcpy Host-to-Device]  

Generated:
    /home/hyoungjo/transformer-cuda/profiles/report.nsys-rep
    /home/hyoungjo/transformer-cuda/profiles/report.sqlite
[SLURM][INFO] Run finished at Sat Dec 20 08:21:33 PM KST 2025
